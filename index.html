<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-05-21">

<title>Statistik Leitfaden R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Statistik_Leitfaden_files/libs/clipboard/clipboard.min.js"></script>
<script src="Statistik_Leitfaden_files/libs/quarto-html/quarto.js"></script>
<script src="Statistik_Leitfaden_files/libs/quarto-html/popper.min.js"></script>
<script src="Statistik_Leitfaden_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Statistik_Leitfaden_files/libs/quarto-html/anchor.min.js"></script>
<link href="Statistik_Leitfaden_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Statistik_Leitfaden_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Statistik_Leitfaden_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Statistik_Leitfaden_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Statistik_Leitfaden_files/libs/bootstrap/bootstrap-061dae09c28a32c5217fe2ca12faf476.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="Statistik_Leitfaden_files/libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="Statistik_Leitfaden_files/libs/tabwid-1.1.3/tabwid.js"></script>
</head><body><img src="logo.png" style="position:absolute; top:10px; right:10px; height:50px;">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>





<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Überblick</h2>
   
  <ul>
  <li><a href="#einführung" id="toc-einführung" class="nav-link active" data-scroll-target="#einführung">Einführung</a>
  <ul class="collapse">
  <li><a href="#files-einlesen" id="toc-files-einlesen" class="nav-link" data-scroll-target="#files-einlesen">Files einlesen</a></li>
  <li><a href="#variablen-transformation" id="toc-variablen-transformation" class="nav-link" data-scroll-target="#variablen-transformation">Variablen Transformation</a>
  <ul class="collapse">
  <li><a href="#variablen-umbennen-umkodieren" id="toc-variablen-umbennen-umkodieren" class="nav-link" data-scroll-target="#variablen-umbennen-umkodieren">Variablen umbennen / umkodieren</a></li>
  <li><a href="#z-standardisierung-zentrierung" id="toc-z-standardisierung-zentrierung" class="nav-link" data-scroll-target="#z-standardisierung-zentrierung">z-Standardisierung &amp; Zentrierung</a></li>
  </ul></li>
  <li><a href="#wide-format-vs.-long-format" id="toc-wide-format-vs.-long-format" class="nav-link" data-scroll-target="#wide-format-vs.-long-format">Wide Format vs.&nbsp;Long Format</a></li>
  <li><a href="#aus-einzelnen-participant-files-ein-gesamt-file-erstellen" id="toc-aus-einzelnen-participant-files-ein-gesamt-file-erstellen" class="nav-link" data-scroll-target="#aus-einzelnen-participant-files-ein-gesamt-file-erstellen">Aus einzelnen Participant-Files ein Gesamt-File erstellen</a></li>
  </ul></li>
  <li><a href="#deskriptive-statistik" id="toc-deskriptive-statistik" class="nav-link" data-scroll-target="#deskriptive-statistik">Deskriptive Statistik</a></li>
  <li><a href="#statistische-verfahren" id="toc-statistische-verfahren" class="nav-link" data-scroll-target="#statistische-verfahren">Statistische Verfahren</a></li>
  <li><a href="#t-test" id="toc-t-test" class="nav-link" data-scroll-target="#t-test">t-Test</a>
  <ul class="collapse">
  <li><a href="#t-test-über-einen-mittelwert" id="toc-t-test-über-einen-mittelwert" class="nav-link" data-scroll-target="#t-test-über-einen-mittelwert">t-Test über einen Mittelwert:</a></li>
  <li><a href="#t-test-über-zwei-unabhängige-stichproben" id="toc-t-test-über-zwei-unabhängige-stichproben" class="nav-link" data-scroll-target="#t-test-über-zwei-unabhängige-stichproben">t-Test über zwei unabhängige Stichproben:</a></li>
  <li><a href="#t-test-über-zwei-abhängige-stichproben" id="toc-t-test-über-zwei-abhängige-stichproben" class="nav-link" data-scroll-target="#t-test-über-zwei-abhängige-stichproben">t-Test über zwei abhängige Stichproben:</a></li>
  <li><a href="#voraussetzungen-t-test" id="toc-voraussetzungen-t-test" class="nav-link" data-scroll-target="#voraussetzungen-t-test">Voraussetzungen t-Test</a></li>
  </ul></li>
  <li><a href="#varianzanalyse-anova" id="toc-varianzanalyse-anova" class="nav-link" data-scroll-target="#varianzanalyse-anova">Varianzanalyse (ANOVA)</a>
  <ul class="collapse">
  <li><a href="#one-between" id="toc-one-between" class="nav-link" data-scroll-target="#one-between">One Between</a></li>
  <li><a href="#one-within" id="toc-one-within" class="nav-link" data-scroll-target="#one-within">One Within</a></li>
  <li><a href="#two-between" id="toc-two-between" class="nav-link" data-scroll-target="#two-between">Two Between</a></li>
  <li><a href="#one-between-one-within-mixed" id="toc-one-between-one-within-mixed" class="nav-link" data-scroll-target="#one-between-one-within-mixed">One Between, One Within (Mixed)</a></li>
  <li><a href="#effektgrößen" id="toc-effektgrößen" class="nav-link" data-scroll-target="#effektgrößen">Effektgrößen</a></li>
  <li><a href="#geplante-vergleiche-post-hoc-tests" id="toc-geplante-vergleiche-post-hoc-tests" class="nav-link" data-scroll-target="#geplante-vergleiche-post-hoc-tests">Geplante Vergleiche / Post-Hoc Tests</a>
  <ul class="collapse">
  <li><a href="#geplante-kontraste" id="toc-geplante-kontraste" class="nav-link" data-scroll-target="#geplante-kontraste">Geplante Kontraste</a></li>
  <li><a href="#post-hoc-tests" id="toc-post-hoc-tests" class="nav-link" data-scroll-target="#post-hoc-tests">Post-Hoc Tests</a></li>
  </ul></li>
  <li><a href="#voraussetzungen-anova" id="toc-voraussetzungen-anova" class="nav-link" data-scroll-target="#voraussetzungen-anova">Voraussetzungen ANOVA</a>
  <ul class="collapse">
  <li><a href="#homoskedastizität-varianzhomogenität" id="toc-homoskedastizität-varianzhomogenität" class="nav-link" data-scroll-target="#homoskedastizität-varianzhomogenität">Homoskedastizität (Varianzhomogenität)</a></li>
  <li><a href="#spherizität" id="toc-spherizität" class="nav-link" data-scroll-target="#spherizität">Spherizität</a></li>
  <li><a href="#normalverteilung-1" id="toc-normalverteilung-1" class="nav-link" data-scroll-target="#normalverteilung-1">Normalverteilung</a></li>
  <li><a href="#unabhängigkeit-der-residuen" id="toc-unabhängigkeit-der-residuen" class="nav-link" data-scroll-target="#unabhängigkeit-der-residuen">Unabhängigkeit der Residuen</a></li>
  <li><a href="#ausreißer" id="toc-ausreißer" class="nav-link" data-scroll-target="#ausreißer">Ausreißer</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#korrelation" id="toc-korrelation" class="nav-link" data-scroll-target="#korrelation">Korrelation</a></li>
  <li><a href="#regression" id="toc-regression" class="nav-link" data-scroll-target="#regression">Regression</a>
  <ul class="collapse">
  <li><a href="#einfache-lineare-regression" id="toc-einfache-lineare-regression" class="nav-link" data-scroll-target="#einfache-lineare-regression">Einfache Lineare Regression</a></li>
  <li><a href="#multiple-lineare-regression" id="toc-multiple-lineare-regression" class="nav-link" data-scroll-target="#multiple-lineare-regression">Multiple Lineare Regression</a></li>
  <li><a href="#voraussetzungen-regression" id="toc-voraussetzungen-regression" class="nav-link" data-scroll-target="#voraussetzungen-regression">Voraussetzungen Regression</a>
  <ul class="collapse">
  <li><a href="#homoskedastizität" id="toc-homoskedastizität" class="nav-link" data-scroll-target="#homoskedastizität">Homoskedastizität</a></li>
  <li><a href="#linearität" id="toc-linearität" class="nav-link" data-scroll-target="#linearität">Linearität</a></li>
  <li><a href="#normalverteilung-der-residuen" id="toc-normalverteilung-der-residuen" class="nav-link" data-scroll-target="#normalverteilung-der-residuen">Normalverteilung der Residuen</a></li>
  <li><a href="#unabhängigkeit-der-residuen-1" id="toc-unabhängigkeit-der-residuen-1" class="nav-link" data-scroll-target="#unabhängigkeit-der-residuen-1">Unabhängigkeit der Residuen</a></li>
  <li><a href="#ausreißer-1" id="toc-ausreißer-1" class="nav-link" data-scroll-target="#ausreißer-1">Ausreißer</a></li>
  </ul></li>
  <li><a href="#mlr-mit-diskretem-prädiktor" id="toc-mlr-mit-diskretem-prädiktor" class="nav-link" data-scroll-target="#mlr-mit-diskretem-prädiktor">MLR mit diskretem Prädiktor</a></li>
  <li><a href="#quadratische-regression" id="toc-quadratische-regression" class="nav-link" data-scroll-target="#quadratische-regression">Quadratische Regression</a></li>
  </ul></li>
  <li><a href="#bootstrapping" id="toc-bootstrapping" class="nav-link" data-scroll-target="#bootstrapping">Bootstrapping</a>
  <ul class="collapse">
  <li><a href="#weitere-ressourcen-für-r" id="toc-weitere-ressourcen-für-r" class="nav-link" data-scroll-target="#weitere-ressourcen-für-r">Weitere Ressourcen für R</a></li>
  </ul></li>
  <li><a href="#notes-footnotes" id="toc-notes-footnotes" class="nav-link" data-scroll-target="#notes-footnotes">Notes &amp; footnotes</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistik Leitfaden R</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Paul Sedlmayr, Maximilian Gerschütz </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 21, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Vorwort
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dieser Leitfaden für statistische Datenanalyse in R soll als ergänzende Ressource zur Lehre an der Universität Graz dienen. Er richtet sich speziell an Studierende, die R für Bachelor- oder Masterarbeiten verwenden wollen, oder sich einfach mit den Grundlagen und Anwendungen statistischer Methoden in R vertraut machen möchten.</p>
<p>Ziel ist es, eine kompakte und verständliche Anleitung bereitzustellen, die das eigenständige Arbeiten mit R erleichtert. Ich erhebe keinen Anspruch auf absolute Richtigkeit oder Vollständigkeit der Inhalte. Der Leitfaden wird regelmäßig aktualisiert. Falls Ihnen Fehler auffallen oder Sie Verbesserungsvorschläge haben, freue ich mich über eine Rückmeldung per E-Mail (<code>paul.sedlmayr@uni-graz.at</code>).</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Diese Seite ist noch nicht fertig gestellt.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<section id="einführung" class="level1">
<h1>Einführung</h1>
<section id="installation-laden-von-packages" class="level4">
<h4 class="anchored" data-anchor-id="installation-laden-von-packages">Installation &amp; Laden von Packages</h4>
<p>Im ersten Schritt installieren und laden wir Packages. Diese enthalten Funktionen, welche wir später nutzen werden. Wenn man ein Package, zum Beispiel das Package tidyverse, zum ersten Mal verwendet, muss man es mit der Funktion <code>install.packages("tidyverse")</code> installieren. Anschließend kann man es mit der Funktion <code>library(tidyverse)</code> laden. Bei <code>install.packages()</code> brauchen wir Anführungszeichen ““, bei bereits heruntergeladenen Packages (<code>library()</code>) nicht.</p>
<p>Um die Packages im folgenden Code zu installieren, entferne das <code>#</code> um den Kommentar <code>#install.packages("tidyverse")</code> zu einer Zeile Code zu verwandeln.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dies ist ein Kommentar</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages installieren install.packages('tidyverse')</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Diese Funktion müssen wir für alle noch nicht heruntergeladenen Packages</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># anwenden. Weitere Packages im Skript: 'rempsyc', 'haven', 'car', 'effectsize'</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ,'psych', 'GGally', 'afex', 'emmeans', 'boot'</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages laden</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  <span class="co"># All-around package</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rempsyc)  <span class="co"># Convenience-functions für Psychologie</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)  <span class="co"># SPSS-Files (.sav) einlesen</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)  <span class="co"># Anova</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(afex)  <span class="co"># Anova</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)  <span class="co"># Post-hoc Tests</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)  <span class="co"># Effektstärkten</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)  <span class="co"># All-around package für Statistik</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)  <span class="co"># Korrelationsmatrix</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lm.beta)  <span class="co"># Standardiertes Regressionsgewicht</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)  <span class="co"># Tabelle in Word konvertieren</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)  <span class="co"># Für schöne lm-Tabelle</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)  <span class="co"># Bootstrapping</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Um Teile aus dem folgenden Code zu nutzen, müssen die jeweiligen Packages heruntergeladen und geladen werden!</p>
</div>
</div>
</section>
<section id="wie-funktionieren-funktionen" class="level4">
<h4 class="anchored" data-anchor-id="wie-funktionieren-funktionen">Wie funktionieren Funktionen</h4>
<p>Die meisten Funktionen in R sind gut dokumentiert. Für eine <code>funktion()</code> können in R mit dem Kommando <code>?funktion</code> die Dokumentation zur jeweiligen Funtion aufrufen. Alternativ kann man (rechts) unter “Help” eine Funktion suchen. Es ist lediglich zu beachten, dass eine Funktion aus einem externen Package (s. oben) zu erst über das Packafe geladen werden muss, um die Dokumentation einsehen zu können. Wenn wir die folgende Zeilen auskommentieren, können wir die Dokumention zur jeweiligen Funktion einsehen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ?library ?lm ?cor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="grundlegende-operatoren" class="level4">
<h4 class="anchored" data-anchor-id="grundlegende-operatoren">Grundlegende Operatoren</h4>
<p>Mit dem assignment operator <code>&lt;-</code> kann man Variablen erstellen. Den Inhalt der Variable kann man ganz einfach einsehen, indem man den Namen der Variable in der Konsole / im Skript ausführt. Alternativ kann man die Funktion <code>print()</code> am jeweiligen Objekt verwenden. Die Funktion <code>c()</code> wird verwendet wenn wir einzelne Objekte zu einem Vektor zusammenfassen. Das ist besonders hilfreich, wenn wir z. B. gezielt mehrere Zeilen oder Spalten eines Dataframes auswählen wollen: <code>df[c("Reihe_1", "Reihe_2"), c("Spalte_1", "Spalte_2")]</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dies ist ein Kommentar</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># oder x = 10</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>text_y <span class="ot">&lt;-</span> <span class="st">"Hello"</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>text_z <span class="ot">&lt;-</span> <span class="st">"WORLD"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print: um ein Objekt zu 'drucken'</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(text_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>text_y_z <span class="ot">&lt;-</span> <span class="fu">c</span>(text_y, text_z)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>text_y_z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello" "WORLD"</code></pre>
</div>
</div>
<p>Der “Pipe-Operator” <code>%&gt;%</code> aus dem <code>tidyverse</code>-Package wird verwendet, um eine Funktion an einem Objekt anzuwenden, ohne das Objekt in der Funktion stehen zu haben. In der herkömmlichen Variante ist es ein Objekt in den Klammern: “<code>f(X)</code>”. Hier liest sich “<code>X %&gt;% f()</code>” wie “nimm <code>X</code> und mache <code>f()</code> damit. Obwohl das nichts am Output verändert, nutzen wir <code>%&gt;%</code>, um eine Struktur im Code zu behalten. Dies ist speziell dann wichtig, wenn man mehrere Funktionen nacheinander anwendet.</p>
<p>Wenn wir beispielsweise eine Tabelle von Autos <code>mtcars</code> 1. nach der Variable <code>mpg</code> (miles per gallon) filtern wollen, 2. bestimmte Variablen auswählen wollen und 3. die Autos dann nach der Leistung (<code>hp</code>) ordnen wollen, brauchen wir nicht zwangsläufig 3 Zeilen Code dafür. Beide Herangehensweisen kommen zum selben Ergebnis</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Normal</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cars_filtered <span class="ot">&lt;-</span> <span class="fu">filter</span>(mtcars, mpg <span class="sc">&gt;</span> <span class="dv">20</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>cars_selected <span class="ot">&lt;-</span> <span class="fu">select</span>(cars_filtered, mpg, cyl, hp)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>cars_final <span class="ot">&lt;-</span> <span class="fu">arrange</span>(cars_selected, <span class="fu">desc</span>(hp))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Mit Pipe %&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>cars_final <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(mpg <span class="sc">&gt;</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(mpg, cyl, hp) <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(hp))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Die ersten 3 Reihen anzeigen</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cars_final, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               mpg cyl  hp
Lotus Europa  30.4   4 113
Mazda RX4     21.0   6 110
Mazda RX4 Wag 21.0   6 110</code></pre>
</div>
</div>
</section>
<section id="mathematische-operatoren" class="level4">
<h4 class="anchored" data-anchor-id="mathematische-operatoren">Mathematische Operatoren</h4>
<p>Man kann einfache Berechnungen mit Zahlen oder Vektoren durchführen. Mit eckigen Klammern kann man Positionen in einem Vektor auswählen / einsehen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector erstellen</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>vec_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>vec_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  5 10 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>vec_1[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>vec_1[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>vec_1[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>vec_1 <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10 20 30</code></pre>
</div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Operation</th>
<th>Zeichen</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Addition</td>
<td>+</td>
</tr>
<tr class="even">
<td>Multiplikation</td>
<td>*</td>
</tr>
<tr class="odd">
<td>Division</td>
<td>/</td>
</tr>
<tr class="even">
<td>Potenz</td>
<td>^</td>
</tr>
</tbody>
</table>
</section>
<section id="files-einlesen" class="level3">
<h3 class="anchored" data-anchor-id="files-einlesen">Files einlesen</h3>
<p>Um ein File einzulesen, müssen wir den Pfad des Files angeben. Befinden sich das Skript und File im selben Ordner, genügt für das csv-File “<code>data_1.csv</code>” der Pfad <code>".//data_1.csv"</code>. Um den Pfad zum File nicht händisch schreiben zu müssen, eignet es sich, mit einem Rechtsklick und “Pfad kopieren” den Link zu kopieren. Bei Problemen kann man im Fenster “Environment” (normalerweise rechts oben) auf “Import Dataset” gehen und ein File manuell einlesen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CSV-Datei einlesen</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data_1.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Um SPSS Files mit dem Typ <code>.sav</code> einzulesen, kann man folgende Funktion aus dem <code>haven</code>-Package verwenden:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SAV-Datei einlesen</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>df_sav <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">".//data_2.sav"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="überblick-verschaffen" class="level4">
<h4 class="anchored" data-anchor-id="überblick-verschaffen">Überblick verschaffen</h4>
<p>Um sich einen Überblick über ein Datenfile zu verschaffen, eignen sich die folgenden Funktionen. Hinweis: <code>$</code> wird verwendet, um eine Spalte auszuwählen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ersten fünf Zeilen</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 21
  Alter Bildungsstand Rauchen gender Herkunftsland Mathematiknote Statistiknote
  &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;         &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;
1    25             4 Nein         1             1              1             1
2    28             5 Nein         1             1              1             2
3    29             2 Ja           2             2              3            NA
4    23             4 Nein         1             1              4             5
5    25             5 Nein         1             2              5             4
# ℹ 14 more variables: wmsva14 &lt;dbl&gt;, Extraversion &lt;dbl&gt;, Neurotizismus &lt;dbl&gt;,
#   Offenheit &lt;dbl&gt;, Gewissenhaftigkeit &lt;dbl&gt;, Verträglichkeit &lt;dbl&gt;, IQ &lt;dbl&gt;,
#   BDI &lt;dbl&gt;, BDI_z2 &lt;dbl&gt;, BDI_c &lt;dbl&gt;, bedingung &lt;chr&gt;, correct_items &lt;dbl&gt;,
#   confidence &lt;dbl&gt;, numerical_ability &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Alter"              "Bildungsstand"      "Rauchen"           
 [4] "gender"             "Herkunftsland"      "Mathematiknote"    
 [7] "Statistiknote"      "wmsva14"            "Extraversion"      
[10] "Neurotizismus"      "Offenheit"          "Gewissenhaftigkeit"
[13] "Verträglichkeit"    "IQ"                 "BDI"               
[16] "BDI_z2"             "BDI_c"              "bedingung"         
[19] "correct_items"      "confidence"         "numerical_ability" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df<span class="sc">$</span>IQ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  79.00   92.50   97.25   96.99  101.62  119.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>bedingung)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Experimental     Kontroll 
          46           52 </code></pre>
</div>
</div>
</section>
</section>
<section id="variablen-transformation" class="level2">
<h2 class="anchored" data-anchor-id="variablen-transformation">Variablen Transformation</h2>
<section id="variablen-umbennen-umkodieren" class="level3">
<h3 class="anchored" data-anchor-id="variablen-umbennen-umkodieren">Variablen umbennen / umkodieren</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable umbenennen nach dem Schema: 'neu' = alt</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">WMS4_delayed_recall =</span> wmsva14)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable transformieren: zu einem Faktor, d.h. Nominalskalenniveau</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Bildungsstand <span class="ot">&lt;-</span> df<span class="sc">$</span>Bildungsstand <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_factor</span>()</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Keine Angabe in Variable 'Rauchen' wird zu NA</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Rauchen[df<span class="sc">$</span>Rauchen <span class="sc">==</span> <span class="st">"Keine Angabe"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Oft wollen wir nominal skalierte Variablen zu Dummy-Variablen umkodieren. Beispielsweise wollen wir die Zugehörigkeit zur Kontroll- oder Experimentalbedingung numerisch zu 1 und 0 kodieren. Die Dummy-Variable erhält das Label <code>experimentalgruppe</code> mit den Ausprägungen 1 (ja <span class="math inline">\(\rightarrow\)</span> gehört zur Experimentalgruppe) und 0 (nein <span class="math inline">\(\rightarrow\)</span> gehört nicht zur Experimentalgruppe). Am besten wählt man ein informatives Label, also eines, welches den Namen der Referenzgruppe beinhaltet. Wenn wir die Variable nur <code>gruppe</code> nennen würden, wäre es nicht klar, welcher Wert zu welcher Gruppe gehört. ==check dummy coding==</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rekodieren zu Dummy Variable</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>experimentalgruppe <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>bedingung <span class="sc">==</span> <span class="st">"Experimental"</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(df<span class="sc">$</span>bedingung <span class="sc">==</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Kontroll"</span>, <span class="dv">0</span>, <span class="cn">NA_real_</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="z-standardisierung-zentrierung" class="level3">
<h3 class="anchored" data-anchor-id="z-standardisierung-zentrierung">z-Standardisierung &amp; Zentrierung</h3>
<p><code>mutate()</code> wird häufig verwendet, um Variablen zu transformieren. Um eine z-standardisierte Variable (hier: <code>BDI_z</code>) aus der herkömmlichen Variable (hier: <code>BDI</code>) zu erstellen, subtrahieren wir den Wert vom Mittelwert (“zentrieren”) und teilen ihn durch die Standardabweichung (<span class="math inline">\(z_i = \frac{x_i - \bar x}{s}\)</span>). Alternativ können wir auch die Funktion <code>scale()</code> verwenden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">BDI_z2 =</span> ((BDI <span class="sc">-</span> <span class="fu">mean</span>(BDI))<span class="sc">/</span><span class="fu">sd</span>(BDI)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der Regression kann es sinnvoll sein, Werte zu zentrieren, um die Ergebnisse besser interpretieren zu können. Zentrieren bedeutet, wir verschieben die Punkte im Koordinatensystem. Das wird typischerweise am Mittelwert durchgeführt (<span class="math inline">\(x_{c,i}=x_i - \bar x\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>BDI_c <span class="ot">&lt;-</span> df<span class="sc">$</span>BDI <span class="sc">-</span> <span class="fu">mean</span>(df<span class="sc">$</span>BDI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="wide-format-vs.-long-format" class="level2">
<h2 class="anchored" data-anchor-id="wide-format-vs.-long-format">Wide Format vs.&nbsp;Long Format</h2>
<p>Das wide und long Format sind die häufigsten Strukturen von Datensätzen. Am besten erkennt man sie an den folgenden Kennzeichen: 1. Im <strong>wide Format</strong> hat jede Person <strong>eine Zeile</strong> 2. Im <strong>long Format</strong> hat jede Person <strong>mehrere Zeilen</strong></p>
<p>Andere Statistikprogramme wie SPSS verwenden oft das wide Format. Im Folgenden lesen wir einen Datensatz ein. Dieser enthält die well-being Werte von Personen mit oder ohne Therapie zu drei Zeitpunkten. Der Datensatz ist im wide Format. Wir haben eine Zeile pro Person und drei Spalten für den Zeitpunkt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df_2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">".//data_2.csv"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  participant_id therapy wellbeing_t0 wellbeing_t1 wellbeing_t2 therapy_group   
           &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;           
1              1       0           58           49           54 no_therapy      
2              2       1           25           52           40 cognitive-behav…
3              3       0           43           42           38 no_therapy      
4              4       1           30           25           32 gestalt         
5              5       1           29           30           37 gestalt         
6              6       0           56           56           64 gestalt         
# ℹ 1 more variable: gender &lt;chr&gt;</code></pre>
</div>
</div>
<p>Die Funktionen <code>pivot_longer()</code> und <code>pivot_wider()</code> aus dem <code>tidyverse</code> sind hierfür hilfreich. Wir konvertieren den Datensatz ins long Format, wo eine Person anschließend eine Zeile pro Zeitpunkt, also insgesamt drei, hat. Wir wollen die Werte aus den drei Spalten in einer Spalte vereinen (<code>values_to = "wellbeing"</code>). Dafür wählen wir die Spalten aus, welche die Werte enthalten (<code>cols = c()</code>). Zusätzlich erstellen wir eine neue Spalte, welche den Zeitpunkt kodiert (<code>names_to = "time"</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Daten ins long-Format bringen: neue Spalte 'time' mit Zeitpunkt sowie</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 'wellbeing' mit Zellenwerten der alten Spalten</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_2) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">colnames</span>(df_2))</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>df_2_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(<span class="at">data =</span> df_2, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"wellbeing_t0"</span>, <span class="st">"wellbeing_t1"</span>, <span class="st">"wellbeing_t2"</span>),</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"time"</span>, <span class="at">values_to =</span> <span class="st">"wellbeing"</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_2_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  participant_id therapy therapy_group        gender time         wellbeing
           &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                &lt;chr&gt;  &lt;chr&gt;            &lt;dbl&gt;
1              1       0 no_therapy           female wellbeing_t0        58
2              1       0 no_therapy           female wellbeing_t1        49
3              1       0 no_therapy           female wellbeing_t2        54
4              2       1 cognitive-behavioral male   wellbeing_t0        25
5              2       1 cognitive-behavioral male   wellbeing_t1        52
6              2       1 cognitive-behavioral male   wellbeing_t2        40</code></pre>
</div>
</div>
<p>Wenn wir die Daten nun zurück ins wide Format bringen wollen, geben wir die Spalte an, welche die unterschiedlichen Zeitpunkte kodiert (<code>names_from = time</code>). Zudem müssen wir die Spalte angeben, welche jene Werte enthält, die wir jetzt wieder auf drei Spalten aufteilen wollen (<code>values_from = "wellbeing"</code>). Wir können zusätzlich angeben, wie zusammen gehörende Werte identifiziert werden sollen, bzw.. welche Spalten unverändert bleiben sollen (<code>id_cols = c("participant_id", "therapy", "therapy_group", "gender")</code>). Wir sehen, dass diese Operation uns den Datensatz im ursprünglichen Zustand zurück gibt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df_2_wide <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(<span class="at">data =</span> df_2_long, <span class="at">names_from =</span> <span class="st">"time"</span>, <span class="at">values_from =</span> <span class="st">"wellbeing"</span>,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">"participant_id"</span>, <span class="st">"therapy"</span>, <span class="st">"therapy_group"</span>, <span class="st">"gender"</span>))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_2_wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  participant_id therapy therapy_group        gender wellbeing_t0 wellbeing_t1
           &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                &lt;chr&gt;         &lt;dbl&gt;        &lt;dbl&gt;
1              1       0 no_therapy           female           58           49
2              2       1 cognitive-behavioral male             25           52
3              3       0 no_therapy           female           43           42
4              4       1 gestalt              male             30           25
5              5       1 gestalt              female           29           30
6              6       0 gestalt              male             56           56
# ℹ 1 more variable: wellbeing_t2 &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="aus-einzelnen-participant-files-ein-gesamt-file-erstellen" class="level2">
<h2 class="anchored" data-anchor-id="aus-einzelnen-participant-files-ein-gesamt-file-erstellen">Aus einzelnen Participant-Files ein Gesamt-File erstellen</h2>
<p>Wenn wir mit einem Programm wie <em>PsychoPy</em> arbeiten, wird für jeden Participant häufig eine separate Excel-Datei erzeugt. Eine zusammengeführter Dataframe liegt jedoch noch nicht vor und muss erst noch von uns erstellt werden. Wir gehen davon aus, dass sich alle <code>.xlsx</code>-Dateien im Ordner <code>data</code> befinden.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dieser Ordner muss im gleichen Verzeichnis liegen wie das aktuelle R-Skript. Nur dann funktioniert der relative Pfad <code>./data</code> korrekt. Ein häufiger Fehler entsteht durch falsch gesetzte Pfade – zur Kontrolle kann man per Rechtsklick auf den <code>data</code>-Ordner den vollständigen Pfad kopieren (siehe auskommentiertes Beispiel unten).</p>
</div>
</div>
<p>Der zentrale Trick: Wir nutzen <code>lapply()</code> und <code>do.call(rbind, ...)</code>, um die Daten aus allen Dateien zeilenweise zu einem Dataframe zusammenzufügen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordnerpfad zu den Daten definieren</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>folder_data <span class="ot">&lt;-</span> <span class="st">"./data"</span>  <span class="co"># ggf. Pfad anpassen!</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># folder_data &lt;- '/Users/deinname/Projekte/Experiment_X/data'</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Prüfen, ob der Datenordner existiert</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(folder_data)) {</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Datenordner nicht gefunden: "</span>, folder_data)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Liste aller Excel-Dateien im Ordner erstellen</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>file_list <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> folder_data, <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">.xlsx$"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Alle Dateien einlesen und in eine Liste speichern</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(file_list, readxl<span class="sc">::</span>read_excel)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Alle Participants zu einem gemeinsamen Dataframe kombinieren</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>df_combined <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, data_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="deskriptive-statistik" class="level1">
<h1>Deskriptive Statistik</h1>
<p>Wir können ganz einfach den Mittelwert und die Standardabweichung von einer Spalte berechnen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df<span class="sc">$</span>Gewissenhaftigkeit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 29.99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(df<span class="sc">$</span>Gewissenhaftigkeit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.04384</code></pre>
</div>
</div>
<p>Um uns deskriptive Statistiken pro Gruppe ausgeben zu lassen, müssen wir <code>group_by()</code> verwenden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>descriptives <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(bedingung) <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">M =</span> <span class="fu">mean</span>(Gewissenhaftigkeit), <span class="at">SD =</span> <span class="fu">sd</span>(Gewissenhaftigkeit), <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>descriptives</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  bedingung        M    SD     n
  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1 Experimental  29.8 10.6     46
2 Kontroll      29.7  9.35    52
3 &lt;NA&gt;          42   12.7      2</code></pre>
</div>
</div>
<p>Zudem bietet das <code>psych</code>-Package eine praktische Funktion:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(df<span class="sc">$</span>Extraversion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   vars   n  mean    sd median trimmed   mad min max range  skew kurtosis se
X1    1 100 30.01 10.01   31.5   30.05 11.12   6  57    51 -0.05    -0.56  1</code></pre>
</div>
</div>
</section>
<section id="statistische-verfahren" class="level1">
<h1>Statistische Verfahren</h1>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Die meisten Funktionen statistischer Verfahren sind folgendermaßen aufgebaut:
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><code>verfahren(Abhängige_Variable ~ Unabhängige_Variable, data = Datensatz)</code>.</p></li>
<li><p><code>verfahren(Variable_A, Variable_B)</code>.</p></li>
</ol>
</div>
</div>
</section>
<section id="t-test" class="level1">
<h1>t-Test</h1>
<section id="t-test-über-einen-mittelwert" class="level3">
<h3 class="anchored" data-anchor-id="t-test-über-einen-mittelwert">t-Test über einen Mittelwert:</h3>
<p><span class="math inline">\(H_0: \mu = 100\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(df<span class="sc">$</span>IQ, <span class="at">mu =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  df$IQ
t = -4.0034, df = 99, p-value = 0.0001208
alternative hypothesis: true mean is not equal to 100
95 percent confidence interval:
 95.49814 98.48186
sample estimates:
mean of x 
    96.99 </code></pre>
</div>
</div>
</section>
<section id="t-test-über-zwei-unabhängige-stichproben" class="level3">
<h3 class="anchored" data-anchor-id="t-test-über-zwei-unabhängige-stichproben">t-Test über zwei unabhängige Stichproben:</h3>
<p>Mit <code>var.equal</code> können wir angeben, ob Varianzhomogenität vorliegt. Wenn die Varianzen nicht homogen sind, verwenden wir den Welch’s t-Test, eine Version des t-Tests bei dem der Standardfehler nicht mit der gepoolten Varianz berechnet wird und die Freiheitsgrade (df) korrigiert sind: S. <code>df = 90.395</code> ist keine ganze Zahl. Der Welch’s t-Test ist die Default-Einstellung bei <code>t.test()</code> für zwei unabhängige Stichproben, da dieser robuster gegenüber unterschiedlich großen Gruppengrößen und Varianzen ist.</p>
<p><span class="math inline">\(H_0: \mu_1 = \mu_2\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Gewissenhaftigkeit <span class="sc">~</span> bedingung, <span class="at">data =</span> df, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Gewissenhaftigkeit by bedingung
t = 0.055123, df = 90.395, p-value = 0.9562
alternative hypothesis: true difference in means between group Experimental and group Kontroll is not equal to 0
95 percent confidence interval:
 -3.925742  4.149823
sample estimates:
mean in group Experimental     mean in group Kontroll 
                  29.80435                   29.69231 </code></pre>
</div>
</div>
</section>
<section id="t-test-über-zwei-abhängige-stichproben" class="level3">
<h3 class="anchored" data-anchor-id="t-test-über-zwei-abhängige-stichproben">t-Test über zwei abhängige Stichproben:</h3>
<p><span class="math inline">\(H_0:\)</span> Das well-being hat sich durch die Intervention nicht verändert.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(df_2<span class="sc">$</span>wellbeing_t0, df_2<span class="sc">$</span>wellbeing_t1, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  df_2$wellbeing_t0 and df_2$wellbeing_t1
t = -6.2885, df = 119, p-value = 5.502e-09
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -8.316598 -4.333402
sample estimates:
mean difference 
         -6.325 </code></pre>
</div>
</div>
</section>
<section id="voraussetzungen-t-test" class="level3">
<h3 class="anchored" data-anchor-id="voraussetzungen-t-test">Voraussetzungen t-Test</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Statistische Voraussetzungen
</div>
</div>
<div class="callout-body-container callout-body">
<p>Beim Testen der Voraussetzungen können wir entweder deskriptivstatistische oder inferenzstatistische Verfahren verwenden. Deskriptivstatistisch kann man die Verfahren mit Plots untersuchen (z.B. Residual Plots, QQ Plots). Inferenzstatistiche Verfahren werden mit Tests durchgeführt (z.B. Kolmogorov-Smirnov Test). Beide Herangehensweisen haben ihre Probleme: 1. Deskriptivstatistische Verfahren sind subjektiv 2. Inferenzstatistische Verfahren haben eine geringe Power in kleinen Stichproben, was dazu führt, dass sie Verletzungen nicht zeigen. In größeren Stichproben haben sie eine hohe Power und werden auch bei geringfügigen Verletzungen signifikant. Das ist ungünstig, da die Verletzungen vor allem in kleinen Stichproben relevant sind. In großen Stichproben und balancierten Designs sind Verfahren wie die ANOVA einigermaßen robust gegen einige der Verletzungen.</p>
<p>Ich persönlich würde die deskriptivstatistischen Verfahren empfehlen. Im Zweifel kann man diese in Kombination mit inferenzstatistischen Verfahren verwenden.</p>
<section id="was-tun-bei-verletzungen" class="level4">
<h4 class="anchored" data-anchor-id="was-tun-bei-verletzungen">Was tun bei Verletzungen?</h4>
<p>Verletzungen sollten immer transparent berichtet werden. Informiere dich darüber, wie sensibel das verwendete statistische Verfahren auf solche Verletzungen reagiert. Falls Korrekturen vorgenommen werden (z.B. robuste Tests, Transformationen), ist es sinnvoll, die Analyse mit und ohne Korrektur durchzuführen und beide Ergebnisse anzugeben. Ein robuster Effekt sollte sich unter beiden Bedingungen zeigen. Dies ist z.B. hilfreich, wenn unklar ist, ob Ausreißer das Ergebnis verzerren. Ergänzend können simulationsbasierte Verfahren wie Bootstrapping oder Randomization Tests eingesetzt werden. Diese reduzieren die Abhängigkeit von theoretischen Annahmen und können die Robustheit der Ergebnisse erhöhen.</p>
</section>
</div>
</div>
<section id="normalverteilung" class="level4">
<h4 class="anchored" data-anchor-id="normalverteilung">Normalverteilung</h4>
<section id="histogramm" class="level5">
<h5 class="anchored" data-anchor-id="histogramm">Histogramm</h5>
<p>Mit einem Histogramm pro Gruppe können wir die Annahme der Normalverteilung grob untersuchen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df_bedingung <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(bedingung))</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_bedingung, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Gewissenhaftigkeit)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>bedingung) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram"</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Häufigkeit"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggplothistttest" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplothistttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-ggplothistttest-1.png" id="fig-ggplothistttest" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-ggplothistttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="qq-plot" class="level5">
<h5 class="anchored" data-anchor-id="qq-plot">QQ-Plot</h5>
<p>Die Normalverteilung können wir mit QQ-Plots testen. Im QQ-Plots wird die Verteilung der Residuen der Stichprobe (durch Punkte gekennzeichnet) mit der Normalverteilung (Strich) verglichen. Die Gerade kennzeichnet eine perfekte Normalverteilung. Je stärker die Punkte von der Linie abweichen, desto stärker weichen die Daten von der Normalverteilung ab.</p>
<p>Im Fall des t-Tests, indem man traditionell nicht von Residuen spricht, kann man die Werte der Personen pro Gruppe plotten. Das Package <code>Rempsyc</code> eine praktische Funktion für QQ-Plots.</p>
<section id="qq-plot-für-gewissenhaftigkeit-für-die-kontrol--und-experimentalbedingung" class="level6">
<h6 class="anchored" data-anchor-id="qq-plot-für-gewissenhaftigkeit-für-die-kontrol--und-experimentalbedingung">QQ-Plot für Gewissenhaftigkeit, für die Kontrol- und Experimentalbedingung</h6>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nice_qq</span>(df_bedingung, <span class="at">variable =</span> <span class="st">"Gewissenhaftigkeit"</span>, <span class="at">group =</span> <span class="st">"bedingung"</span>, <span class="at">title =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-remqqttest" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-remqqttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-remqqttest-1.png" id="fig-remqqttest" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-remqqttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="varianzhomogenität" class="level4">
<h4 class="anchored" data-anchor-id="varianzhomogenität">Varianzhomogenität</h4>
<p>Diese müssen wir im Fall vom t-Test über zwei unabhängige Stichproben testen. Hier können wir den Levene’s Test verwenden. Dieser testet die <span class="math inline">\(H_0\)</span>, dass die Varianzen der Gruppen homogen sind. Ein signifikanter Wert deutet darauf hin, dass die Varianzen heterogen sind, also eine Verletzung der Annahme der Homoskedastizität.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Gewissenhaftigkeit <span class="sc">~</span> bedingung, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1   2.606 0.1097
      96               </code></pre>
</div>
</div>
<p>Die <code>t.test()</code>-Funktion testet per default, ob die Varianzen homogen sind. Bei einer Verletzung wird automatisch der Welch-Test verwendet</p>
<p>Allgemein ist der t-Test ziemlich robust gegenüber Verletzungen der Voraussetzungen.</p>
</section>
</section>
</section>
<section id="varianzanalyse-anova" class="level1">
<h1>Varianzanalyse (ANOVA)</h1>
<p>Klassischerweise wird für die ANOVA häufig die Funktion <code>aov()</code> verwendet. Im Folgenden werden wir jedoch das Package <code>afex</code> nutzen, da dies u.a. Vorteile bei unbalancierten Stichproben und bei Messwiederholung (Within-Subject) hat. Hier können wir die Funktion <code>aov_ez()</code> verwenden.</p>
<p>Diese Funktion benötigt allerdings eine Participant-ID (<code>id =</code>). Falls diese nicht vorhanden ist, können wir sie einfach hinzufügen, wenn es eine Zeile pro Participant gibt (wide Format). Wir zählen von 1 bis zur Gesamtanzahl der AV-Werte (<code>df_2_wide$wellbeing_t2)</code>) und fügen diese als <code>participant</code> hinzu. Gibt es einen Within-Subject Factor und die Daten sind im long Format ist das etwas komplizierter: bei einer Messwiederholung mit <span class="math inline">\(m\)</span> Stufen bedeutet das <span class="math inline">\(m\)</span> Zeilen pro Participant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ID Spalte pro Participant hinzufügen</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>df_2_wide<span class="sc">$</span>participant_id <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(df_2_wide<span class="sc">$</span>wellbeing_t2))</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Between-UV's als Faktor konvertieren</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>df_2_wide<span class="sc">$</span>therapy_group <span class="ot">&lt;-</span> df_2_wide<span class="sc">$</span>therapy_group <span class="sc">%&gt;%</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_factor</span>()</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>df_2_wide<span class="sc">$</span>gender <span class="ot">&lt;-</span> df_2_wide<span class="sc">$</span>gender <span class="sc">%&gt;%</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_factor</span>()</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>df_2_wide<span class="sc">$</span>therapy <span class="ot">&lt;-</span> df_2_wide<span class="sc">$</span>therapy <span class="sc">%&gt;%</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_factor</span>()</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>df_2_long<span class="sc">$</span>gender <span class="ot">&lt;-</span> df_2_long<span class="sc">$</span>gender <span class="sc">%&gt;%</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_factor</span>()</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>df_2_long<span class="sc">$</span>therapy <span class="ot">&lt;-</span> df_2_long<span class="sc">$</span>therapy <span class="sc">%&gt;%</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_factor</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="one-between" class="level3">
<h3 class="anchored" data-anchor-id="one-between">One Between</h3>
<p>In R wird klassicherweise die Funktion <code>aov()</code> für die ANOVA verwendet. Da die Berechnung der Quadratsummen in <code>aov()</code> etwas anders geschieht als in anderen Programmen wie SPSS (Typ II vs.&nbsp;Typ III Quadratsummen), beschränke ich mich in diesem Skript auf die Funktion <code>aov_ez()</code> aus dem <code>afex</code>-Package.</p>
<p>Wir untersuchen, wie sich verschiedene Therapieformen – keine Therapie, kognitiv-behaviorale Therapie (CBT) und Gestalt-Therapie – auf das Well-Being auswirken. Zur Veranschaulichung einer ANOVA mit einem Between-Subjects-Faktor betrachten wir ausschließlich den Messzeitpunkt t2 und ignorieren die anderen Zeitpunkte (t0 und t1), die einen Within-Subjects-Faktor bilden würden. Die abhängige Variable ist somit wellbeing_t2.</p>
<p>Unter <code>ges</code> wird das Eta-Quadrat ausgegeben.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>anova_bet <span class="ot">&lt;-</span> <span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"participant_id"</span>, <span class="at">dv =</span> <span class="st">"wellbeing_t2"</span>, <span class="at">between =</span> <span class="st">"therapy_group"</span>,</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_2_wide)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>anova_bet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: wellbeing_t2
         Effect     df    MSE       F  ges p.value
1 therapy_group 2, 117 480.03 5.23 ** .082    .007
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternativ mit aov() aov(wellbeing ~ therapy, data = df_2_long)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="one-within" class="level3">
<h3 class="anchored" data-anchor-id="one-within">One Within</h3>
<p>Für die ANOVA mit Messwiederholung (Within-Subject Factor) können wir die Funktion <code>aov_ez()</code> aus dem <code>afex()</code>-Package verwenden. Diese hat den Vorteil, dass sie bei Verletzung der Spherizität korrigierte Ergebnisse angibt. Im Folgenden Output wird darauf hingewiesen, dass nach einer Verletzung der Spherizität eine Greenhouse-Geisser-Korrektur angewandt wurde. Das können wir auch daran erkennen, dass die Freiheitsgrade keine ganzen Zahlen sind.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>anova_within <span class="ot">&lt;-</span> <span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"participant_id"</span>, <span class="at">dv =</span> <span class="st">"wellbeing"</span>, <span class="at">within =</span> <span class="st">"time"</span>,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es =</span> <span class="st">"pes"</span>), <span class="at">data =</span> df_2_long)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>anova_within</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: wellbeing
  Effect           df   MSE         F  pes p.value
1   time 1.87, 222.44 83.11 42.74 *** .264   &lt;.001
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_2_long, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> wellbeing, <span class="at">fill =</span> time)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.color =</span> <span class="st">"red"</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Well-being über Zeit"</span>,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Zeitpunkt"</span>, <span class="at">y =</span> <span class="st">"Well-being Score"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="co"># Remove legend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-boxplottanova" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplottanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-boxplottanova-1.png" id="fig-boxplottanova" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-boxplottanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="two-between" class="level3">
<h3 class="anchored" data-anchor-id="two-between">Two Between</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>anova_2_bet <span class="ot">&lt;-</span> <span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"participant_id"</span>, <span class="at">dv =</span> <span class="st">"wellbeing_t2"</span>, <span class="at">between =</span> <span class="fu">c</span>(<span class="st">"therapy_group"</span>,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gender"</span>), <span class="at">data =</span> df_2_wide, <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es =</span> <span class="st">"pes"</span>))</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>anova_2_bet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: wellbeing_t2
                Effect     df    MSE      F  pes p.value
1        therapy_group 2, 114 476.03 4.55 * .074    .013
2               gender 1, 114 476.03   2.13 .018    .148
3 therapy_group:gender 2, 114 476.03   0.89 .015    .414
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternativ mit aov() anova_result &lt;- aov(wellbeing_t2 ~ gender *</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># therapy_group, data = df_2_wide)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="interaction-plot" class="level4">
<h4 class="anchored" data-anchor-id="interaction-plot">Interaction Plot</h4>
<p>Mit <code>interaction.plot(UV_1, UV_2, AV)</code> können wir einen Interaktions-Plot erstellen</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(df_2_wide<span class="sc">$</span>therapy_group, df_2_wide<span class="sc">$</span>gender, df_2_wide<span class="sc">$</span>wellbeing_t2,</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">legend =</span> <span class="cn">TRUE</span>, <span class="at">xlab =</span> <span class="st">"Art der Therapie"</span>,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Well-being zu Zeitpunkt 2"</span>, <span class="at">trace.label =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-interactionanova" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interactionanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-interactionanova-1.png" id="fig-interactionanova" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-interactionanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="one-between-one-within-mixed" class="level3">
<h3 class="anchored" data-anchor-id="one-between-one-within-mixed">One Between, One Within (Mixed)</h3>
<p>Für die ANOVA mit Messwiederholung (Within-Subject Factor) können wir wieder die Funktion <code>aov_ez()</code> verwenden. Diese hat den Vorteil, dass sie bei Verletzung der Spherizität automatisch korrigierte Ergebnisse angibt.</p>
<p>Hinweis: im folgenden Teil <code>anova_table = list(es = "pes")</code> geben wir mit <code>"es = pes"</code> das partielle Eta-Quadrat aud (<span class="math inline">\(\hat \eta_{par}^2\)</span>). Wir können uns auch das generalisierte Eta-Quadrat (<span class="math inline">\(\hat \eta^2\)</span>) ausgeben (<code>es = "ges"</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>anova_mixed <span class="ot">&lt;-</span> <span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"participant_id"</span>, <span class="at">dv =</span> <span class="st">"wellbeing"</span>, <span class="at">within =</span> <span class="st">"time"</span>, <span class="at">between =</span> <span class="st">"therapy_group"</span>,</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_2_long, <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es =</span> <span class="st">"pes"</span>), <span class="at">include_aov =</span> <span class="cn">TRUE</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_mixed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Univariate Type III Repeated-Measures ANOVA Assuming Sphericity

                   Sum Sq num Df Error SS den Df  F value    Pr(&gt;F)    
(Intercept)        944166      1   124395    117 888.0403 &lt; 2.2e-16 ***
therapy_group        4435      2   124395    117   2.0858    0.1288    
time                 6471      2    15504    234  48.8343 &lt; 2.2e-16 ***
therapy_group:time   2983      4    15504    234  11.2549 2.277e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Mauchly Tests for Sphericity

                   Test statistic    p-value
time                      0.84931 7.6891e-05
therapy_group:time        0.84931 7.6891e-05


Greenhouse-Geisser and Huynh-Feldt Corrections
 for Departure from Sphericity

                    GG eps Pr(&gt;F[GG])    
time               0.86904  2.305e-16 ***
therapy_group:time 0.86904  1.524e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                      HF eps   Pr(&gt;F[HF])
time               0.8810133 1.485331e-16
therapy_group:time 0.8810133 1.280591e-07</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(df_2_long<span class="sc">$</span>time, df_2_long<span class="sc">$</span>therapy_group, df_2_long<span class="sc">$</span>wellbeing, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"purple"</span>,</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"orange"</span>, <span class="st">"green"</span>), <span class="at">legend =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">xlab =</span> <span class="st">"Zeit"</span>, <span class="at">ylab =</span> <span class="st">"Well-being"</span>,</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace.label =</span> <span class="st">"Therapie"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-interactionanova2" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interactionanova2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-interactionanova2-1.png" id="fig-interactionanova2" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-interactionanova2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Interaktionsplots können mit <code>interaction.plot()</code> leicht erstellt werden. Für detailliertere Grafiken bietet <code>ggplot()</code> allerdings deutlich mehr Optionen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_2_long, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> wellbeing, <span class="at">color =</span> therapy_group, <span class="at">group =</span> therapy_group)) <span class="sc">+</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span> <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Well-Being über Zeit in Abhängigkeit von der Therapie "</span>, <span class="at">x =</span> <span class="st">"Zeit"</span>,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Well-Being"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Statistik_Leitfaden_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="effektgrößen" class="level2">
<h2 class="anchored" data-anchor-id="effektgrößen">Effektgrößen</h2>
<p>Das partielle Eta-Quadrat <span class="math inline">\(\hat \eta_{par}^2\)</span> können wir aus den Ergebnissen der gerechneten Varianzanalyse berechnen. Hierfür können wir die <code>eta_squared()</code>-Funktion aus dem Package <code>effectsize</code> verwenden. Diese berechnet zusätzlich ein 95%-iges Konfidenzintervall. Mit dem Parameter <code>partial = TRUE</code>, bzw. <code>generalized = TRUE</code> können wir uns speziell für das partielle oder generalisierte Eta-Quadrat entscheiden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">eta_squared</span>(anova_mixed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type III)

Parameter          | Eta2 (partial) |       95% CI
--------------------------------------------------
therapy_group      |           0.03 | [0.00, 1.00]
time               |           0.29 | [0.22, 1.00]
therapy_group:time |           0.16 | [0.09, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<p>Das Omega-Quadrat <span class="math inline">\(\hat \omega^2_{par}\)</span> ist eine korrigierte Alternative zum Eta-Quadrat. Das partielle Eta-Quadrat ist positiv gebiased: unsystematische Zufallsvarianz wird zum Teil für systematische Effektvarianz gehalten. Daher wird das partielle Omega-Quadrat korrigiert und fällt idR. kleiner aus als das partielle Eta-Quadrat. Wenn <span class="math inline">\(\hat \omega^2_{par}\)</span> negativ ausfällt, ist es auf 0.00 zu setzen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">omega_squared</span>(anova_mixed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type III)

Parameter          | Omega2 (partial) |       95% CI
----------------------------------------------------
therapy_group      |             0.02 | [0.00, 1.00]
time               |             0.04 | [0.01, 1.00]
therapy_group:time |             0.02 | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
</section>
<section id="geplante-vergleiche-post-hoc-tests" class="level2">
<h2 class="anchored" data-anchor-id="geplante-vergleiche-post-hoc-tests">Geplante Vergleiche / Post-Hoc Tests</h2>
<section id="geplante-kontraste" class="level3">
<h3 class="anchored" data-anchor-id="geplante-kontraste">Geplante Kontraste</h3>
<p>Anders als bei post-hoc Tests werden geplante Kontraste (Vergleiche) formuliert, bevor wir unsere Analysen rechnen bzw. die Daten begutachten. Das bedeutet, wir formulieren eine Hypothese und testen sie dann mit unseren Daten. Solche Erkenntnisse sind deutlich schwerer zu gewichten als Erkenntnisse, auf die wir bei Analyse der Daten explorativ stoßen. Geplante Kontraste sind im Prinzip wie ein t-Test. Wenn man mehr als zwei Gruppen vergleicht, kann man jedoch die unbekannte Populationsvarianz besser schätzen. Daher verfügen geplante Kontraste über eine höhere Power als wenn man alternativ nur einzelne t-Tests rechnen würde.</p>
<p>Wir untersuchen am Beispiel der Anova mit einem Between-Subject Factor die a-priori formulierte Hypothese, dass sich Personen mit Kognitiv-behavioraler Therapie von Patient*innen mit Gestalt-Therapie nach der Intervention (Zeitpunkt 2) unterscheiden, unabhängig von Patient*innen auf der Warteliste (ohne Therapie). Hierfür müssen wir die Mittelwerte mit Kontrastgewichten versehen. Zu erst erstellen wir die “Estimated Marginal Means” und schauen, wie die Levels unseres Faktors geordnet sind. Dadurch wissen wir, wie wir sie im nächsten Schritt gewichten müssen.</p>
<p>Wir gewichten den Mittelwert von Gruppe 2 (CBT) mit +1, den von Gruppe 3 (Gestalt) mit -1. Da uns Gruppe 1 (keine Therapie) in diesem Vergleich nicht interessiert, wird ihr Mittelwert mit 0 gewichtet. Wir können mit <code>contrast()</code> die Kontraste eines Faktors manuell überschreiben. Dem Vergleich von kognitiv-behavioraler Therapie vs.&nbsp;Gestalt-Therapie geben wir den Namen “CBT_vs_Gestalt” und legen die Gewichte wie beschrieben fest: <code>c(0, 1, -1)</code>.</p>
<p><span class="math inline">\(H_0: 0 \cdot \mu_{kontroll} + 1  \cdot \mu_{gestalt} - 1 \cdot \mu_{CBT} = 0\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One Between ANOVA</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>anova_bet <span class="ot">&lt;-</span> <span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"participant_id"</span>, <span class="at">dv =</span> <span class="st">"wellbeing_t2"</span>, <span class="at">between =</span> <span class="st">"therapy_group"</span>,</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_2_wide, <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es =</span> <span class="st">"pes"</span>))</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>estimated_marginal_means <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(anova_bet, <span class="sc">~</span>therapy_group)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>estimated_marginal_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> therapy_group        emmean   SE  df lower.CL upper.CL
 no_therapy             47.6 3.38 117     40.9     54.3
 cognitive-behavioral   62.7 3.38 117     56.0     69.4
 gestalt                58.4 3.65 117     51.2     65.6

Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df_2_wide<span class="sc">$</span>therapy_group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "no_therapy"           "cognitive-behavioral" "gestalt"             </code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kontrast festlegen</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>contrast_custom <span class="ot">&lt;-</span> <span class="fu">contrast</span>(estimated_marginal_means, <span class="at">method =</span> <span class="fu">list</span>(<span class="at">CBT_vs_Gestalt_t2 =</span> <span class="fu">c</span>(<span class="dv">0</span>,</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(contrast_custom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast          estimate   SE  df t.ratio p.value
 CBT_vs_Gestalt_t2     4.28 4.98 117   0.860  0.3918</code></pre>
</div>
</div>
<p>Mit der folgenden <code>rempsyc</code>-Funktion können wir uns für alle Kontraste, Cohen’s d ausgeben lassen und mittels Bootstrapping Konfidenzintervalle erstellen lassen. Diese sind allerdings nicht in Hinsicht auf Multiples Testen korrigiert und es werden alle möglichen Kontraste angegeben, also auch solche, die nicht unbedingt a-priori geplant wurden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)  <span class="co"># for reproducability</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nice_contrasts</span>(<span class="at">data =</span> df_2_wide, <span class="at">response =</span> <span class="st">"wellbeing_t2"</span>, <span class="at">group =</span> <span class="st">"therapy_group"</span>,</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">effect.type =</span> <span class="st">"cohens.d"</span>, <span class="at">bootstraps =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Dependent Variable                          Comparison  df          t
1       wellbeing_t2 no_therapy - (cognitive-behavioral) 117 -3.1473290
2       wellbeing_t2                no_therapy - gestalt 117 -2.1642260
3       wellbeing_t2    (cognitive-behavioral) - gestalt 117  0.8596299
            p          d   CI_lower    CI_upper
1 0.002090484 -0.6868035 -1.1489937 -0.23961259
2 0.032479097 -0.4915571 -0.9191963 -0.07776868
3 0.391751002  0.1952464 -0.2544289  0.59530035</code></pre>
</div>
</div>
<section id="komplexe-kontraste" class="level4">
<h4 class="anchored" data-anchor-id="komplexe-kontraste">Komplexe Kontraste</h4>
<p>In komplexen Kontrasten vergleichen wir anders als bei paarweisen Vergleichen nicht eine Bedingung mir einer anderen, sondern beispielsweise eine Bedingung mit zwei anderen Bedingungen. Wir wollen untersuchen, ob sich Patient*innen auf der Warteliste, also ohne Therapie (Gruppe 1) von Personen unterscheiden, die in Therapie sind (Gruppen 2 &amp; 3). Wir gewichten den Mittelwert von Gruppe 1 mit 1 und jene von Gruppen 2 &amp; 3 mit jeweils -0.5. Auf beiden Seiten müssen die Werte gleich groß sein (1 vs.&nbsp;-(0.5+0.5)). Der Wert von 0.5 statt 1 sorgt dafür, dass die Mittelwerte von Gruppen 2 &amp; 3 gemittelt werden (2 * 0.5 = 1). Das negative Vorzeichen bestimmt, welche Gruppe auf welcher Seite des Kontrasts steht. Welche Gruppe negativ bzw. positiv gewichtet wird, ist uns überlassen.</p>
<p><span class="math inline">\(H_0: 1 \cdot \mu_1 - 0.5  \cdot \mu_2 + 0.5  \cdot \mu_3 = 0\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>anova_bet <span class="ot">&lt;-</span> <span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"participant_id"</span>, <span class="at">dv =</span> <span class="st">"wellbeing_t2"</span>, <span class="at">between =</span> <span class="st">"therapy_group"</span>,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_2_wide, <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es =</span> <span class="st">"pes"</span>))</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>contrast_matrix <span class="ot">&lt;-</span> <span class="fu">contrast</span>(estimated_marginal_means, <span class="at">method =</span> <span class="fu">list</span>(<span class="at">Waiting_list_vs_Therapy =</span> <span class="fu">c</span>(<span class="dv">1</span>,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>)))</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(contrast_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                estimate  SE  df t.ratio p.value
 Waiting_list_vs_Therapy    -12.9 4.2 117  -3.075  0.0026</code></pre>
</div>
</div>
<p>Hinweis: es gibt eine alternative Version, um Kontrast mit der weit verbreiteten Funktion zur Varianzanalyse (<code>aov()</code>) zu rechnen: mit <code>aov()</code> <span class="math inline">\(\rightarrow\)</span> <code>contrasts()</code> <span class="math inline">\(\rightarrow\)</span> <code>summary.lm()</code>.</p>
</section>
<section id="bonferoni" class="level4">
<h4 class="anchored" data-anchor-id="bonferoni">Bonferoni</h4>
<p>In der Bonferoni-Korrektur wird gegen Multiples Testen korrigiert, indem jeder p-Wert eines Vergleichs mit der Anzahl der Vergleiche multipliziert wird (<span class="math inline">\(N * p_j \leq \alpha'\)</span>), oder alternativ dass das Signifikanzniveau <span class="math inline">\(\alpha\)</span> durch die Anzahl der Vergleiche geteilt wird (<span class="math inline">\(p_j \leq \frac{\alpha'}{N}\)</span>). Hier gilt daher: Je mehr Vergleiche wir durchführen, desto geringer muss ein Signifikanzniveau sein, um signifikant zu werden. Daher ist es sinnvoll, sich die Vergleiche genau zu überlegen und nicht alle möglichen Vergleiche zu rechnen.</p>
<p>Dadurch ist dieses Kriterium konservativer als beispielsweise die Tukey-Kramer Korrektur. Die einzelnen Hypothesen müssen allerdings nicht unabhängig sein.</p>
<p>Unter <code>$contrasts</code> werden die Vergleiche der einzelnen Stufen angegeben. Unter <code>$emmeans</code> bekommen wir die geschätzten Mittelwerte für jede Stufe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bonferoni</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>anova_mixed <span class="ot">&lt;-</span> <span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"participant_id"</span>, <span class="at">dv =</span> <span class="st">"wellbeing"</span>, <span class="at">within =</span> <span class="st">"time"</span>, <span class="at">between =</span> <span class="st">"therapy_group"</span>,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_2_long, <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es =</span> <span class="st">"pes"</span>), <span class="at">include_aov =</span> <span class="cn">TRUE</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>emm_mixed <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(anova_mixed, <span class="sc">~</span>therapy_group <span class="sc">*</span> time)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(emm_mixed)  <span class="co"># Reihenfolge der Kontraste überprüfen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> therapy_group        time           emmean       SE  df lower.CL upper.CL
 cognitive-behavioral wellbeing_t0 44.07143 2.820427 117 38.48572 49.65714
 gestalt              wellbeing_t0 49.66667 3.046409 117 43.63341 55.69992
 no_therapy           wellbeing_t0 43.85714 2.820427 117 38.27143 49.44285
 cognitive-behavioral wellbeing_t1 56.69048 3.014171 117 50.72107 62.65988
 gestalt              wellbeing_t1 51.00000 3.255677 117 44.55230 57.44770
 no_therapy           wellbeing_t1 48.16667 3.014171 117 42.19726 54.13607
 cognitive-behavioral wellbeing_t2 62.66667 3.380731 117 55.97131 69.36203
 gestalt              wellbeing_t2 58.38889 3.651607 117 51.15707 65.62071
 no_therapy           wellbeing_t2 47.61905 3.380731 117 40.92369 54.31441

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>In der vorliegenden Mixed ANOVA erhalten wir für jedes Level des Between-Subject Factors zu jedem Level des Within-Subject Factors den Estimated Marginal Mean. Nun wählen wir basierend auf der vorherigen Reihenfolge diejenigen aus, welche wir vergleichen wollen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>anova_mixed_contrasts <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm_mixed, <span class="at">method =</span> <span class="fu">list</span>(<span class="at">CBT_vs_Gestalt_t2 =</span> <span class="fu">c</span>(<span class="dv">0</span>,</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>), <span class="at">Waiting_list_vs_Therapy_t2 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>,</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.5</span>, <span class="sc">-</span><span class="dv">1</span>)), <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_mixed_contrasts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                   estimate   SE  df t.ratio p.value
 CBT_vs_Gestalt_t2              4.28 4.98 117   0.860  0.7835
 Waiting_list_vs_Therapy_t2    12.91 4.20 117   3.075  0.0052

P value adjustment: bonferroni method for 2 tests </code></pre>
</div>
</div>
</section>
</section>
<section id="post-hoc-tests" class="level3">
<h3 class="anchored" data-anchor-id="post-hoc-tests">Post-Hoc Tests</h3>
<section id="tukey-hsd" class="level5">
<h5 class="anchored" data-anchor-id="tukey-hsd">Tukey HSD</h5>
<p>Die Tukey-Kramer-Korrektur ist ein Verfahren zur Kontrolle des Fehlerniveaus bei multiplen paarweisen Vergleichen von Faktorstufen, insbesondere im Rahmen von Post-hoc-Analysen nach einer signifikanten ANOVA. Die Korrektur schützt vor Multiplen Testen, indem sie die Signifikanzschwelle am größten möglichen Unterschied aller Gruppen orientiert – also an der extremsten Konstellation. Wenn beispielsweise der größte Unterschied zwischen CBT und keiner Therapie besteht, bemessen wir daran, wie hoch andere Unterschiede sein müssen, um signifikant zu werden. Im Vergleich zur Bonferroni-Korrektur oder zum Scheffe-Test ist die Power der Tukey-Korrektur höher, d.h., kleinere Effekte können eher erkannt werden. Ein weiterer Vorteil ist, dass die einzelnen Hypothesentests nicht unabhängig voneinander sein müssen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>emm_only_t2 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(anova_mixed, <span class="sc">~</span>therapy_group, <span class="at">at =</span> <span class="fu">list</span>(<span class="at">time =</span> <span class="st">"wellbeing_t2"</span>))</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_only_t2, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                            estimate   SE  df t.ratio p.value
 (cognitive-behavioral) - gestalt        4.28 4.98 117   0.860  0.6667
 (cognitive-behavioral) - no_therapy    15.05 4.78 117   3.147  0.0059
 gestalt - no_therapy                   10.77 4.98 117   2.164  0.0817

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<p>Wir können auch einen Plot mit simultanen Konfidenzintervallen anzeigen lassen. Dabei handelt es sich um Konfidenzintervalle, die für multiples Testen korrigiert sind (family-wise). Hier auf Basis von Tukey’s Honest Significant Difference (HSD):</p>
<p>Hinweis: Im folgenden Beispiel verwenden wir nicht die <code>aov_ez()</code> Funktion mit <code>emmeans()</code> sondern die <code>aov()</code>-Funktion mit <code>TukeyHSD()</code>. Die genannten Funktionen stammen aus unterschiedlichen Packages und sind zum Teil nicht kompatibel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>aov_2_bet <span class="ot">&lt;-</span> <span class="fu">aov</span>(wellbeing_t2 <span class="sc">~</span> therapy_group <span class="sc">+</span> gender, <span class="at">data =</span> df_2_wide)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>posthoc_tukey_2 <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(aov_2_bet)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Just for plotting</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="fl">13.5</span>, <span class="dv">4</span>, <span class="dv">2</span>))</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(posthoc_tukey_2, <span class="at">las =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-confidenceintervalplots-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-confidenceintervalplots-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-confidenceintervalplots-1.png" id="fig-confidenceintervalplots-1" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-confidenceintervalplots-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-confidenceintervalplots-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-confidenceintervalplots-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-confidenceintervalplots-2.png" id="fig-confidenceintervalplots-2" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-confidenceintervalplots-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="scheffe-test" class="level5">
<h5 class="anchored" data-anchor-id="scheffe-test">Scheffe Test</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scheffe Post-Hoc Test</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>pairwise_scheffe <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(aov_2_bet, pairwise <span class="sc">~</span> therapy_group <span class="sc">+</span> gender, <span class="at">adjust =</span> <span class="st">"scheffe"</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>pairwise_scheffe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 therapy_group        gender emmean   SE  df lower.CL upper.CL
 no_therapy           female   50.6 3.92 116     42.8     58.4
 cognitive-behavioral female   65.1 3.73 116     57.7     72.5
 gestalt              female   61.7 4.26 116     53.3     70.1
 no_therapy           male     44.6 3.92 116     36.9     52.4
 cognitive-behavioral male     59.1 4.13 116     50.9     67.3
 gestalt              male     55.7 4.05 116     47.7     63.8

Confidence level used: 0.95 

$contrasts
 contrast                                                    estimate   SE  df
 no_therapy female - (cognitive-behavioral female)             -14.48 4.77 116
 no_therapy female - gestalt female                            -11.10 4.96 116
 no_therapy female - no_therapy male                             5.97 4.01 116
 no_therapy female - (cognitive-behavioral male)                -8.51 6.48 116
 no_therapy female - gestalt male                               -5.13 6.23 116
 (cognitive-behavioral female) - gestalt female                  3.38 4.99 116
 (cognitive-behavioral female) - no_therapy male                20.45 5.98 116
 (cognitive-behavioral female) - (cognitive-behavioral male)     5.97 4.01 116
 (cognitive-behavioral female) - gestalt male                    9.35 6.01 116
 gestalt female - no_therapy male                               17.07 6.52 116
 gestalt female - (cognitive-behavioral male)                    2.59 6.77 116
 gestalt female - gestalt male                                   5.97 4.01 116
 no_therapy male - (cognitive-behavioral male)                 -14.48 4.77 116
 no_therapy male - gestalt male                                -11.10 4.96 116
 (cognitive-behavioral male) - gestalt male                      3.38 4.99 116
 t.ratio p.value
  -3.034  0.0307
  -2.240  0.1767
   1.487  0.5318
  -1.314  0.6321
  -0.823  0.8782
   0.677  0.9276
   3.417  0.0108
   1.487  0.5318
   1.555  0.4930
   2.620  0.0822
   0.383  0.9857
   1.487  0.5318
  -3.034  0.0307
  -2.240  0.1767
   0.677  0.9276

P value adjustment: scheffe method with rank 3 </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="voraussetzungen-anova" class="level2">
<h2 class="anchored" data-anchor-id="voraussetzungen-anova">Voraussetzungen ANOVA</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Statistische Voraussetzungen
</div>
</div>
<div class="callout-body-container callout-body">
<p>Beim Testen der Voraussetzungen können wir entweder deskriptivstatistische oder inferenzstatistische Verfahren verwenden. Deskriptivstatistisch kann man die Verfahren mit Plots untersuchen (z.B. Residual Plots, QQ Plots). Inferenzstatistiche Verfahren werden mit Tests durchgeführt (z.B. Kolmogorov-Smirnov Test). Beide Herangehensweisen haben ihre Probleme: 1. Deskriptivstatistische Verfahren sind subjektiv 2. Inferenzstatistische Verfahren haben eine geringe Power in kleinen Stichproben, was dazu führt, dass sie Verletzungen nicht zeigen. In größeren Stichproben haben sie eine hohe Power und werden auch bei geringfügigen Verletzungen signifikant. Das ist ungünstig, da die Verletzungen vor allem in kleinen Stichproben relevant sind. In großen Stichproben und balancierten Designs sind Verfahren wie die ANOVA einigermaßen robust gegen einige der Verletzungen.</p>
<p>Ich persönlich würde die deskriptivstatistischen Verfahren empfehlen. Im Zweifel kann man diese in Kombination mit inferenzstatistischen Verfahren verwenden.</p>
<section id="was-tun-bei-verletzungen-1" class="level4">
<h4 class="anchored" data-anchor-id="was-tun-bei-verletzungen-1">Was tun bei Verletzungen?</h4>
<p>Verletzungen sollten immer transparent berichtet werden. Informiere dich darüber, wie sensibel das verwendete statistische Verfahren auf solche Verletzungen reagiert. Falls Korrekturen vorgenommen werden (z.B. robuste Tests, Transformationen), ist es sinnvoll, die Analyse mit und ohne Korrektur durchzuführen und beide Ergebnisse anzugeben. Ein robuster Effekt sollte sich unter beiden Bedingungen zeigen. Dies ist z.B. hilfreich, wenn unklar ist, ob Ausreißer das Ergebnis verzerren. Ergänzend können simulationsbasierte Verfahren wie Bootstrapping oder Randomization Tests eingesetzt werden. Diese reduzieren die Abhängigkeit von theoretischen Annahmen und können die Robustheit der Ergebnisse erhöhen.</p>
</section>
</div>
</div>
<section id="homoskedastizität-varianzhomogenität" class="level3">
<h3 class="anchored" data-anchor-id="homoskedastizität-varianzhomogenität">Homoskedastizität (Varianzhomogenität)</h3>
<p>Homoskedastizität ist die eine zentrale Annahme in der ANOVA: die Varianzen in den Gruppen sind gleich, bzw. ähnlich groß (“homogen”). Eine Verletzung der Homoskedastizität ist schwerwiegender wenn die Gruppen unterschiedlich groß sind.</p>
<section id="residual-plot" class="level4">
<h4 class="anchored" data-anchor-id="residual-plot">Residual Plot</h4>
<p>Um die Homoskedastizität zu überprüfen, erstellen wir einen Residual Plot. Die Residuen bezeichnen Abweichungen eines beobachteten Wertes vom vorhergesagten Wert. In der ANOVA ist das die Abweichung eines Wert <span class="math inline">\(y_{ij}\)</span> vom jeweiligen Gruppenmittelwert <span class="math inline">\(\hat y_j\)</span>. Daher: <span class="math inline">\(e_{ij} = y_{ij} - \hat y_j\)</span>. Im folgenden Residual Plot für eine 2x3 ANOVA mit zwei Between-Subjects Factors haben wir sechs Untergruppen. Das zeigt sich in sechs verschieden “fitted” Values, also den jeweiligen Gruppenmittelwerten. Die Residuen sind als Abweichungen von den jeweiligen fitted Values zu sehen.</p>
<p>Wir wollen, dass die Varianz in allen Gruppen ähnlich groß ist. Daher schauen wir uns an, ob die Residuen ähnlich um 0 streuen. Zudem zeigt der Residual Plot potentielle Ausreißer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>anova_2_bet <span class="ot">&lt;-</span> <span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"participant_id"</span>, <span class="at">dv =</span> <span class="st">"wellbeing_t2"</span>, <span class="at">between =</span> <span class="fu">c</span>(<span class="st">"therapy_group"</span>,</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gender"</span>), <span class="at">data =</span> df_2_wide, <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es =</span> <span class="st">"pes"</span>))</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract residuals and fitted values</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(anova_2_bet)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>fitted_values <span class="ot">&lt;-</span> <span class="fu">fitted</span>(anova_2_bet)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot residuals against fitted values</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">jitter</span>(fitted_values), residuals, <span class="at">xlab =</span> <span class="st">"Fitted Values"</span>, <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"Residuals of Sub-Groups"</span>)</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-residualplotanova" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residualplotanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-residualplotanova-1.png" id="fig-residualplotanova" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-residualplotanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8
</figcaption>
</figure>
</div>
</div>
</div>
<p>Siehe <a href="#fig-residuenplotregression" class="quarto-xref">Figure&nbsp;17</a> für einen Residual Plot in der Regression.</p>
</section>
<section id="levenes-test" class="level4">
<h4 class="anchored" data-anchor-id="levenes-test">Levene’s Test</h4>
<p>Alternativ können wir den Levene’s Test verwenden. Dieser testet die <span class="math inline">\(H_0\)</span>, dass die Varianzen der Gruppen homogen sind. Ein signifikanter Wert deutet darauf hin, dass die Varianzen heterogen sind, also eine Verletzung der Annahme der Homoskedastizität.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(wellbeing_t2 <span class="sc">~</span> therapy_group <span class="sc">*</span> gender, <span class="at">data =</span> df_2_wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
       Df F value Pr(&gt;F)
group   5  0.9899 0.4272
      114               </code></pre>
</div>
</div>
</section>
</section>
<section id="spherizität" class="level3">
<h3 class="anchored" data-anchor-id="spherizität">Spherizität</h3>
<p>Spherizität ist eine Erweiterung der Homoskedastizität bei Messwiederholungs-Designs (mit Within-Subject Factor). Die Spherizität beschreibt, dass die Varianz der Differenzen zwischen den Messzeitpunkten konstant ist. Ein einfaches Beispiel wäre der IQ gemessen im Alter von 17, 18 und 30 Jahren. Die Messungen im Alter von 17 und 18 Jahren würden sich deutlich weniger unterscheiden (=geringere Varianz der Differenzen) als beispielsweise bei 18 und 30 Jahren.</p>
<p><span class="math inline">\(H_0 = \sigma^2_{y_1 - y_2} = \sigma^2_{y_1 - y_3} = \sigma^2_{y_2 - y_3}\)</span></p>
<p><span class="math inline">\(H_1 = \sigma^2_{y_1 - y_2} \not = \sigma^2_{y_1 - y_3} \not = \sigma^2_{y_2 - y_3}\)</span></p>
<p>Wenn wir uns die <code>summary()</code> einer ANOVA mit <code>aov_ez()</code> ausgeben, sehen wir zunächst die nicht-korrigierten Ergebnisse. Darunter wird uns bei <code>Mauchly Tests for Sphericity</code> eine Verletzung der Spherizität angezeigt (<span class="math inline">\(p&lt;.05\)</span>). Es wird jeweils ein Greenhouse-Geisser und Huynh-Feldt Epsilon zur Korrektur angegeben. Wenn wir uns einfach nur das <code>aov_ez()</code>-ANOVA Objekt ausgeben lassen, sind die Ergebnisse bei Verletzung der Spherizität automatisch korrigiert: Die Freiheitsgrade des F-Tests sind mit dem Greenhouse-Geisser Epsilon multipliziert.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>anova_within <span class="ot">&lt;-</span> <span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"participant_id"</span>, <span class="at">dv =</span> <span class="st">"wellbeing"</span>, <span class="at">within =</span> <span class="st">"time"</span>,</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es =</span> <span class="st">"pes"</span>), <span class="at">data =</span> df_2_long)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_within)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Univariate Type III Repeated-Measures ANOVA Assuming Sphericity

            Sum Sq num Df Error SS den Df F value    Pr(&gt;F)    
(Intercept) 946075      1   128830    119 873.888 &lt; 2.2e-16 ***
time          6639      2    18487    238  42.737 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Mauchly Tests for Sphericity

     Test statistic  p-value
time        0.93003 0.013849


Greenhouse-Geisser and Huynh-Feldt Corrections
 for Departure from Sphericity

      GG eps Pr(&gt;F[GG])    
time 0.93461  1.159e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

       HF eps   Pr(&gt;F[HF])
time 0.948965 7.268579e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>anova_within</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: wellbeing
  Effect           df   MSE         F  pes p.value
1   time 1.87, 222.44 83.11 42.74 *** .264   &lt;.001
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
</section>
<section id="normalverteilung-1" class="level3">
<h3 class="anchored" data-anchor-id="normalverteilung-1">Normalverteilung</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die ANOVA ist einigermaßen robust gegen eine Verletzung der Normalverteilung, es sei denn die Verteilung ist in der Population sehr schief oder Gruppengrößen sind unterschiedlich groß. Hierbei ist es relevant, dass die Messwerte, bzw. Residuen, in den Gruppen normalverteilt sind, nicht die Daten allgemein (Stellen Sie sich bei drei Gruppen z.B. drei Normalverteilungen vor, die zum Teil überlappen. Die Daten wären nicht normalverteilt, in den Gruppen aber schon.)</p>
</div>
</div>
<section id="histogram" class="level4">
<h4 class="anchored" data-anchor-id="histogram">Histogram</h4>
<p>Mit einem Histogramm pro Gruppe können wir die Annahme der Normalverteilung grob untersuchen. Hierfür können wir die Residuen oder die Werte pro Gruppe verwenden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_2_wide, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> wellbeing_t2)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>,</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>therapy_group) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram"</span>,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Häufigkeit"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggplothist" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplothist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-ggplothist-1.png" id="fig-ggplothist" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-ggplothist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="qq-plot-1" class="level4">
<h4 class="anchored" data-anchor-id="qq-plot-1">QQ-Plot</h4>
<p>Die Normalverteilung können wir mit QQ-Plots testen. Im QQ-Plots wird die Verteilung der Residuen der Stichprobe (durch Punkte gekennzeichnet) mit der Normalverteilung (Strich) verglichen. Die Gerade kennzeichnet eine perfekte Normalverteilung. Je stärker die Punkte von der Linie abweichen, desto stärker weichen die Daten von der Normalverteilung ab.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wir haben die Residuen zuvor extrahiert: residuals &lt;- residuals(anova_result)</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>df_2_wide<span class="sc">$</span>residual <span class="ot">&lt;-</span> residuals</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(df_2_wide<span class="sc">$</span>residual, <span class="at">main =</span> <span class="st">"QQ-Plot"</span>)</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(df_2_wide<span class="sc">$</span>residual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-qqplotanova" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-qqplotanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-qqplotanova-1.png" id="fig-qqplotanova" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-qqplotanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10
</figcaption>
</figure>
</div>
</div>
</div>
<p>Das Package <code>Rempsyc</code> eine praktische Funktion für QQ-Plots. Hier können wir (bei Bedarf) auch einstellen, dass wir die Verteilungen der einzelnen Gruppen untersuchen wollen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nice_qq</span>(df_2_wide, <span class="at">variable =</span> <span class="st">"residual"</span>, <span class="at">title =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-remqq" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-remqq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-remqq-1.png" id="fig-remqq" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-remqq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="shapiro-wilk-test" class="level4">
<h4 class="anchored" data-anchor-id="shapiro-wilk-test">Shapiro Wilk Test</h4>
<p>Zur Überprüfung der Normalverteilungsannahme der Residuen können wir auch einen inferenzstatistischen Test, wie den Shapiro-Wilk-Test, verwenden. Dabei testen wir, ob die Residuen innerhalb jeder Gruppe (nicht die abhängige Variable insgesamt!) signifikant von einer Normalverteilung abweichen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals
W = 0.99267, p-value = 0.7831</code></pre>
</div>
</div>
</section>
</section>
<section id="unabhängigkeit-der-residuen" class="level3">
<h3 class="anchored" data-anchor-id="unabhängigkeit-der-residuen">Unabhängigkeit der Residuen</h3>
<p>Die Annahme der Unabhängigkeit ist verletzt, wenn sich systematische Abhängigkeiten in den Daten ergeben, die im Modell nicht berücksichtigt werden. Wenn Teilnehmende der kognitiv-behavioralen und Gestalt-Therapie aus unterschiedlichen Praxen rekrutiert wurden, könnten sich Clustereffekte ergeben – etwa durch unterschiedliche Therapeut*innen oder Standorte. Solche Abhängigkeiten führen zu korrelierten Residuen innerhalb der Cluster, was gegen die Unabhängigkeitsannahme verstößt.</p>
<p>Da sich Unabhängigkeit nicht direkt statistisch testen lässt, wird sie primär über das Studiendesign beurteilt. Bei Hinweisen auf Clusterbildung sind komplexere Mixed-Effects-Modelle geeigneter als die ANOVA.</p>
</section>
<section id="ausreißer" class="level3">
<h3 class="anchored" data-anchor-id="ausreißer">Ausreißer</h3>
<p>Ausreißer können das Ergebnis der ANOVA stark beeinflussen. Wir können den Residual Plot (<a href="#fig-residualplotanova" class="quarto-xref">Figure&nbsp;8</a>) oder Box-Plot (<a href="#fig-boxplottanova" class="quarto-xref">Figure&nbsp;3</a>) nutzen, um Ausreißer zu identifizieren.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Das Ausschließen von Ausreißern ist ein kontroverses Thema. Im Zweifel lohnt es sich, zu untersuchen ob der Effekt auch ohne Ausreißer oder in einem rang-basierten Verfahren besteht. Zudem kann Bootstrapping verwendet werden, um die Robustheit der Ergebnisse zu bestärken.</p>
</div>
</div>
</section>
</section>
</section>
<section id="korrelation" class="level1">
<h1>Korrelation</h1>
<p>Mittels <code>cor()</code> können wir den Korrelationskoeffizienten berechnen. Im Parameter <code>use</code> können wir angeben, wie wir mit fehlenden Werten (<code>NA</code>) umgehen wollen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>Extraversion, df<span class="sc">$</span>Neurotizismus, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.3951064</code></pre>
</div>
</div>
<p>Mit <code>cor.test()</code> können wir auf Signifikanz testen. Zudem wird automatisch ein <code>95%</code>-Konfidenzintervall ausgegeben</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(df<span class="sc">$</span>Extraversion, df<span class="sc">$</span>Neurotizismus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  df$Extraversion and df$Neurotizismus
t = -4.2578, df = 98, p-value = 4.738e-05
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.5489247 -0.2154050
sample estimates:
       cor 
-0.3951064 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>cor_ex_neu <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(df<span class="sc">$</span>Extraversion, df<span class="sc">$</span>Neurotizismus, <span class="at">use =</span> <span class="st">"complete.obs"</span>, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>r_value <span class="ot">&lt;-</span> cor_ex_neu<span class="sc">$</span>estimate  <span class="co"># Pearson-Korrelation (r)</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> cor_ex_neu<span class="sc">$</span>p.value  <span class="co"># p-value</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="ot">&lt;-</span> cor_ex_neu<span class="sc">$</span>conf.int[<span class="dv">1</span>]  <span class="co"># Untere Grenze des 95% KI</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>ci_upper <span class="ot">&lt;-</span> cor_ex_neu<span class="sc">$</span>conf.int[<span class="dv">2</span>]  <span class="co"># Obere Grenze des 95% KI</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="rangkorrelation" class="level4">
<h4 class="anchored" data-anchor-id="rangkorrelation">Rangkorrelation</h4>
<p>Im Parameter <code>method</code> können wir ebenfalls die Spearman-Korrelation und Kendall’s Tau auswählen, welche Rang-basiert sind.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(df<span class="sc">$</span>Extraversion, df<span class="sc">$</span>Neurotizismus, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  df$Extraversion and df$Neurotizismus
S = 237928, p-value = 9.056e-06
alternative hypothesis: true rho is not equal to 0
sample estimates:
       rho 
-0.4277128 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(df<span class="sc">$</span>Extraversion, df<span class="sc">$</span>Neurotizismus, <span class="at">method =</span> <span class="st">"kendall"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kendall's rank correlation tau

data:  df$Extraversion and df$Neurotizismus
z = -4.3629, p-value = 1.283e-05
alternative hypothesis: true tau is not equal to 0
sample estimates:
       tau 
-0.3037607 </code></pre>
</div>
</div>
</section>
<section id="korrelationsmatrix" class="level4">
<h4 class="anchored" data-anchor-id="korrelationsmatrix">Korrelationsmatrix</h4>
<p>Es gibt verschiedene Möglichkeiten, eine Korrelations-Matrix oder Scatterplot-Matrix erstellen zu lassen:</p>
<ol type="1">
<li>Die <code>cor()</code>-Funktion mit mehreren Spalten eines Dataframes.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df[, <span class="fu">c</span>(<span class="st">"IQ"</span>, <span class="st">"numerical_ability"</span>, <span class="st">"WMS4_delayed_recall"</span>)], <span class="at">method =</span> <span class="st">"pearson"</span>,</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           IQ numerical_ability WMS4_delayed_recall
IQ                  1.0000000         0.2742733           0.1796224
numerical_ability   0.2742733         1.0000000           0.2233780
WMS4_delayed_recall 0.1796224         0.2233780           1.0000000</code></pre>
</div>
</div>
<ol start="2" type="1">
<li><code>ggpairs()</code> aus dem <code>GGally</code>-Package.</li>
</ol>
<p>Hier können wir uns eine Hälfte der Matrix als Scatterplot Matrix ausgeben lassen (unter <code>lower</code>). Die <code>method</code> gibt hier an, ob die Regressionslinie gerade sein soll (<code>method = "lm"</code>) oder eine “lokale”, daher nicht-gerade Regressionslinie (<code>method = "loess"</code>). Letzteres ist sinnvoll, um die Voraussetzung der <strong>Linearität</strong> überprüfen will. Zusätzlich kann man sich den Standardfehler der Regressionslinie angeben lassen (<code>se = TRUE</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(df, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"IQ"</span>, <span class="st">"numerical_ability"</span>, <span class="st">"WMS4_delayed_recall"</span>), <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">"smooth"</span>,</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)), <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">"cor"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggpairscorplot" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggpairscorplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-ggpairscorplot-1.png" id="fig-ggpairscorplot" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-ggpairscorplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12
</figcaption>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li>Das <code>psych()</code>-Package bietet eine ähnliche Funktion.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(df[, <span class="fu">c</span>(<span class="st">"IQ"</span>, <span class="st">"numerical_ability"</span>, <span class="st">"WMS4_delayed_recall"</span>)], <span class="at">ellipses =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-psychcorplot" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-psychcorplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-psychcorplot-1.png" id="fig-psychcorplot" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-psychcorplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="regression" class="level1">
<h1>Regression</h1>
<section id="einfache-lineare-regression" class="level3">
<h3 class="anchored" data-anchor-id="einfache-lineare-regression">Einfache Lineare Regression</h3>
<p>Die Syntax der Einfachen Linearen Regression ist im selben Schema wie zuvor: <code>AV ~ UV</code>. Über <code>summary()</code> können wir uns wieder die Ergebnisse ausgeben lassen.</p>
<p>Das unstandardisierte Regressionsgewicht von IQ ist unter <code>Estimate</code> zu finden. Daneben den zugehörigen Standardfehler, t-Wert und zugehörigen p-Wert. Das <code>Multiple R-squared</code> entspricht dem <span class="math inline">\(R^2\)</span>, der gesamten durch das Modell aufgeklärten Varianz.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>model_simple_regression <span class="ot">&lt;-</span> <span class="fu">lm</span>(IQ <span class="sc">~</span> WMS4_delayed_recall, <span class="at">data =</span> df)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_simple_regression)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IQ ~ WMS4_delayed_recall, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-17.5701  -4.4016   0.2258   4.4372  22.3459 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         92.87477    2.39496  38.779   &lt;2e-16 ***
WMS4_delayed_recall  0.08398    0.04646   1.808   0.0737 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.434 on 98 degrees of freedom
Multiple R-squared:  0.03226,   Adjusted R-squared:  0.02239 
F-statistic: 3.267 on 1 and 98 DF,  p-value: 0.07374</code></pre>
</div>
</div>
<p>Die standardisierten Regressionskoeffizienten, also der <span class="math inline">\(\beta\)</span>-Koeffizient, werden leider nicht automatisch mit ausgegeben. Mit dem Package <code>lm.beta</code> können wir diese bekommen. In der einfachen linearen Regression sind diese identisch mit der Pearson-Korrelation. Die ist in der MLR nicht der Fall, es sei denn die Prädiktoren haben keine gemeinsame Varianz.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm.beta</span>(model_simple_regression)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IQ ~ WMS4_delayed_recall, data = df)

Standardized Coefficients::
        (Intercept) WMS4_delayed_recall 
                 NA           0.1796224 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>IQ, df<span class="sc">$</span>WMS4_delayed_recall)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1796224</code></pre>
</div>
</div>
<p>Wir können uns auch die Übersicht über das gesamte Model inkl. der standardisierten Regressionskoeffizienten unter <code>Standardized</code> ausgeben lassen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm.beta</span>(model_simple_regression))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IQ ~ WMS4_delayed_recall, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-17.5701  -4.4016   0.2258   4.4372  22.3459 

Coefficients:
                    Estimate Standardized Std. Error t value Pr(&gt;|t|)    
(Intercept)         92.87477           NA    2.39496  38.779   &lt;2e-16 ***
WMS4_delayed_recall  0.08398      0.17962    0.04646   1.808   0.0737 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.434 on 98 degrees of freedom
Multiple R-squared:  0.03226,   Adjusted R-squared:  0.02239 
F-statistic: 3.267 on 1 and 98 DF,  p-value: 0.07374</code></pre>
</div>
</div>
<p>Wir können uns ganz einfach ein Konfidenzintervall für unser unstandardisiertes Regressionsgewicht angeben lassen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model_simple_regression)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           2.5 %     97.5 %
(Intercept)         88.122037168 97.6274941
WMS4_delayed_recall -0.008219086  0.1761878</code></pre>
</div>
</div>
<p>Das Package <code>rempsyc</code> bietet nützliche Funktionen, um Ergebnis-Tabellen zu erstellen. Diese sind zum Großteil APA-konform. Ich rate jedoch, das Format bei Verwendung noch einmal zu überprüfen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>model_slr_results <span class="ot">&lt;-</span> <span class="fu">nice_lm</span>(model_simple_regression)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>model_slr_results[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"WMS4 delayed recall"</span>  <span class="co"># WMS als Prädiktor</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>model_slr_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Dependent Variable           Predictor df          b        t          p
1                 IQ WMS4 delayed recall 98 0.08398438 1.807571 0.07374123
         sr2 CI_lower  CI_upper
1 0.03226422        0 0.1004032</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>model_slr_results <span class="ot">&lt;-</span> <span class="fu">nice_table</span>(model_slr_results, <span class="at">title =</span> <span class="fu">c</span>(<span class="st">"Tabelle 1"</span>, <span class="st">"Zusammenhang von Gedächtnisfähigkeit (verzögerte Wiedergabe) und Intelligenz"</span>),</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">note =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">"Diese Tablle ist als Beispiel gedacht. Alle Zusammenhänge sind frei erfunden."</span>,</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">sep =</span> <span class="st">" "</span>), <span class="st">"* p &lt; .05, ** p &lt; .01, *** p &lt; .001"</span>))</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Um Tabelle als Word-Datei zu speichern</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="co"># flextable::save_as_docx(model_slr_results, path = 'model_slr_results.docx')</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>model_slr_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-niceslr" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-niceslr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tabwid"><style>.cl-e20cdb94{table-layout:auto;}.cl-e1fabaae{font-family:'Times New Roman';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e1fabab8{font-family:'Times New Roman';font-size:12pt;font-weight:bold;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e1fabac2{font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e1fabac3{font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e1fabac4{font-family:'Times New Roman';font-size:7.2pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.6pt;}.cl-e1fbcd5e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-e1fbcd68{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-e1fbcd69{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e1fbd83a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e1fbd844{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e1fbd845{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e1fbd846{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e1fbd847{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e1fbd84e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-e20cdb94"><thead><tr style="overflow-wrap:break-word;"><th colspan="8" class="cl-e1fbd83a"><p class="cl-e1fbcd5e"><span class="cl-e1fabaae">Tabelle 1</span></p></th></tr><tr style="overflow-wrap:break-word;"><th colspan="8" class="cl-e1fbd844"><p class="cl-e1fbcd5e"><span class="cl-e1fabac2">Zusammenhang von Gedächtnisfähigkeit (verzögerte Wiedergabe) und Intelligenz</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-e1fbd845"><p class="cl-e1fbcd68"><span class="cl-e1fabac3">Dependent Variable</span></p></th><th class="cl-e1fbd845"><p class="cl-e1fbcd68"><span class="cl-e1fabac3">Predictor</span></p></th><th class="cl-e1fbd845"><p class="cl-e1fbcd68"><span class="cl-e1fabac2">df</span></p></th><th class="cl-e1fbd845"><p class="cl-e1fbcd68"><span class="cl-e1fabac2">b</span></p></th><th class="cl-e1fbd845"><p class="cl-e1fbcd68"><span class="cl-e1fabac2">t</span></p></th><th class="cl-e1fbd845"><p class="cl-e1fbcd68"><span class="cl-e1fabac2">p</span></p></th><th class="cl-e1fbd845"><p class="cl-e1fbcd68"><span class="cl-e1fabac2">sr</span><span class="cl-e1fabac4">2</span></p></th><th class="cl-e1fbd845"><p class="cl-e1fbcd68"><span class="cl-e1fabac3">95% CI</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e1fbd846"><p class="cl-e1fbcd5e"><span class="cl-e1fabac3">IQ</span></p></td><td class="cl-e1fbd847"><p class="cl-e1fbcd68"><span class="cl-e1fabac3">WMS4 delayed recall</span></p></td><td class="cl-e1fbd847"><p class="cl-e1fbcd68"><span class="cl-e1fabac3">98</span></p></td><td class="cl-e1fbd847"><p class="cl-e1fbcd68"><span class="cl-e1fabac3">0.08</span></p></td><td class="cl-e1fbd847"><p class="cl-e1fbcd68"><span class="cl-e1fabac3">1.81</span></p></td><td class="cl-e1fbd847"><p class="cl-e1fbcd68"><span class="cl-e1fabac3">.074</span></p></td><td class="cl-e1fbd847"><p class="cl-e1fbcd68"><span class="cl-e1fabac3">.03</span></p></td><td class="cl-e1fbd847"><p class="cl-e1fbcd68"><span class="cl-e1fabac3">[0.00, 0.10]</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="8" class="cl-e1fbd84e"><p class="cl-e1fbcd69"><span class="cl-e1fabac2">Note. </span><span class="cl-e1fabac3">Diese Tablle ist als Beispiel gedacht. Alle Zusammenhänge sind frei erfunden.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="8" class="cl-e1fbd84e"><p class="cl-e1fbcd69"><span class="cl-e1fabac3">* p &lt; .05, ** p &lt; .01, *** p &lt; .001</span></p></td></tr></tfoot></table></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-niceslr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14
</figcaption>
</figure>
</div>
</div>
</section>
<section id="multiple-lineare-regression" class="level3">
<h3 class="anchored" data-anchor-id="multiple-lineare-regression">Multiple Lineare Regression</h3>
<p><span class="math display">\[Y_i = \alpha + \beta_1 \cdot x_{i1} + \beta_2 \cdot x_{i2} + \beta_3 (x_{i1} \cdot x_{i2}) + \epsilon_i\]</span></p>
<p>Die Syntax für die MLR bleibt gleich: wir fügen weiter Prädiktoren (UVs) mit <code>+</code> ein, sowie eine Interaktion durch <code>*</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>model_mlr <span class="ot">&lt;-</span> <span class="fu">lm</span>(IQ <span class="sc">~</span> numerical_ability <span class="sc">+</span> WMS4_delayed_recall <span class="sc">+</span> numerical_ability <span class="sc">*</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>    WMS4_delayed_recall, <span class="at">data =</span> df)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>model_mlr_stan <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm.beta</span>(model_mlr))  <span class="co"># für standardisiertes Regressionsgewicht</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>model_mlr_stan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IQ ~ numerical_ability + WMS4_delayed_recall + numerical_ability * 
    WMS4_delayed_recall, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-17.2927  -4.2766  -0.3574   4.7839  21.2556 

Coefficients:
                                       Estimate Standardized Std. Error t value
(Intercept)                           101.56636           NA   11.45125   8.869
numerical_ability                      -1.17597     -0.26172    1.70302  -0.691
WMS4_delayed_recall                    -0.26905     -0.56999    0.24117  -1.116
numerical_ability:WMS4_delayed_recall   0.04855      0.95857    0.03494   1.390
                                      Pr(&gt;|t|)    
(Intercept)                           5.04e-14 ***
numerical_ability                        0.492    
WMS4_delayed_recall                      0.267    
numerical_ability:WMS4_delayed_recall    0.168    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.275 on 93 degrees of freedom
  (3 observations deleted due to missingness)
Multiple R-squared:  0.1088,    Adjusted R-squared:  0.08009 
F-statistic: 3.786 on 3 and 93 DF,  p-value: 0.01302</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>model_mlr_table <span class="ot">&lt;-</span> <span class="fu">tidy</span>(model_mlr_stan)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(model_mlr_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"b"</span>, <span class="st">"β"</span>, <span class="st">"SE"</span>, <span class="st">"t"</span>, <span class="st">"p"</span>)  <span class="co"># '\u03B2' kann statt β verwendet werden</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>model_mlr_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  Variable                                     b      β      SE      t        p
  &lt;chr&gt;                                    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)                           102.     NA     11.5     8.87  5.04e-14
2 numerical_ability                      -1.18   -0.262  1.70   -0.691 4.92e- 1
3 WMS4_delayed_recall                    -0.269  -0.570  0.241  -1.12  2.67e- 1
4 numerical_ability:WMS4_delayed_recall   0.0486  0.959  0.0349  1.39  1.68e- 1</code></pre>
</div>
</div>
<p>Wir können uns ganz einfach das Konfidenzintervall zum unstandardisierten Regressionsgewicht ausgeben lassen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model_mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                            2.5 %      97.5 %
(Intercept)                           78.82644712 124.3062730
numerical_ability                     -4.55783587   2.2058863
WMS4_delayed_recall                   -0.74795511   0.2098634
numerical_ability:WMS4_delayed_recall -0.02083538   0.1179372</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nice_table</span>(model_mlr_table, <span class="at">title =</span> <span class="fu">c</span>(<span class="st">"Tabelle 2"</span>, <span class="st">"Vorhersage der Intelligenz durch Gedächtnisfähigkeit (verzögerte Wiedergabe) und numerischen Fähigkeiten"</span>),</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">note =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">"Diese Tablle ist als Beispiel gedacht. Alle Zusammenhänge sind frei erfunden."</span>,</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">sep =</span> <span class="st">" "</span>), <span class="st">"* p &lt; .05, ** p &lt; .01, *** p &lt; .001"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-nicemlr" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nicemlr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tabwid"><style>.cl-e21d7fbc{table-layout:auto;}.cl-e21b0660{font-family:'Times New Roman';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e21b066a{font-family:'Times New Roman';font-size:12pt;font-weight:bold;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e21b066b{font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e21b066c{font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e21c0876{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-e21c0877{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-e21c0880{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e21c13a2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e21c13a3{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e21c13a4{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e21c13ac{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e21c13ad{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e21c13ae{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e21c13af{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e21c13b6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-e21d7fbc"><thead><tr style="overflow-wrap:break-word;"><th colspan="6" class="cl-e21c13a2"><p class="cl-e21c0876"><span class="cl-e21b0660">Tabelle 2</span></p></th></tr><tr style="overflow-wrap:break-word;"><th colspan="6" class="cl-e21c13a3"><p class="cl-e21c0876"><span class="cl-e21b066b">Vorhersage der Intelligenz durch Gedächtnisfähigkeit (verzögerte Wiedergabe) und numerischen Fähigkeiten</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-e21c13a4"><p class="cl-e21c0877"><span class="cl-e21b066c">Variable</span></p></th><th class="cl-e21c13a4"><p class="cl-e21c0877"><span class="cl-e21b066b">b</span></p></th><th class="cl-e21c13a4"><p class="cl-e21c0877"><span class="cl-e21b066c">β</span></p></th><th class="cl-e21c13a4"><p class="cl-e21c0877"><span class="cl-e21b066b">SE</span></p></th><th class="cl-e21c13a4"><p class="cl-e21c0877"><span class="cl-e21b066b">t</span></p></th><th class="cl-e21c13a4"><p class="cl-e21c0877"><span class="cl-e21b066b">p</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e21c13ac"><p class="cl-e21c0876"><span class="cl-e21b066c">(Intercept)</span></p></td><td class="cl-e21c13ad"><p class="cl-e21c0877"><span class="cl-e21b066c">101.57</span></p></td><td class="cl-e21c13ad"><p class="cl-e21c0877"><span class="cl-e21b066c"></span></p></td><td class="cl-e21c13ad"><p class="cl-e21c0877"><span class="cl-e21b066c">11.45</span></p></td><td class="cl-e21c13ad"><p class="cl-e21c0877"><span class="cl-e21b066c">8.87</span></p></td><td class="cl-e21c13ad"><p class="cl-e21c0877"><span class="cl-e21b066c">&lt; .001***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e21c13ac"><p class="cl-e21c0876"><span class="cl-e21b066c">numerical_ability</span></p></td><td class="cl-e21c13ad"><p class="cl-e21c0877"><span class="cl-e21b066c">-1.18</span></p></td><td class="cl-e21c13ad"><p class="cl-e21c0877"><span class="cl-e21b066c">-0.26</span></p></td><td class="cl-e21c13ad"><p class="cl-e21c0877"><span class="cl-e21b066c">1.70</span></p></td><td class="cl-e21c13ad"><p class="cl-e21c0877"><span class="cl-e21b066c">-0.69</span></p></td><td class="cl-e21c13ad"><p class="cl-e21c0877"><span class="cl-e21b066c">.492</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e21c13ac"><p class="cl-e21c0876"><span class="cl-e21b066c">WMS4_delayed_recall</span></p></td><td class="cl-e21c13ad"><p class="cl-e21c0877"><span class="cl-e21b066c">-0.27</span></p></td><td class="cl-e21c13ad"><p class="cl-e21c0877"><span class="cl-e21b066c">-0.57</span></p></td><td class="cl-e21c13ad"><p class="cl-e21c0877"><span class="cl-e21b066c">0.24</span></p></td><td class="cl-e21c13ad"><p class="cl-e21c0877"><span class="cl-e21b066c">-1.12</span></p></td><td class="cl-e21c13ad"><p class="cl-e21c0877"><span class="cl-e21b066c">.267</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e21c13ae"><p class="cl-e21c0876"><span class="cl-e21b066c">numerical_ability:WMS4_delayed_recall</span></p></td><td class="cl-e21c13af"><p class="cl-e21c0877"><span class="cl-e21b066c">0.05</span></p></td><td class="cl-e21c13af"><p class="cl-e21c0877"><span class="cl-e21b066c">0.96</span></p></td><td class="cl-e21c13af"><p class="cl-e21c0877"><span class="cl-e21b066c">0.03</span></p></td><td class="cl-e21c13af"><p class="cl-e21c0877"><span class="cl-e21b066c">1.39</span></p></td><td class="cl-e21c13af"><p class="cl-e21c0877"><span class="cl-e21b066c">.168</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-e21c13b6"><p class="cl-e21c0880"><span class="cl-e21b066b">Note. </span><span class="cl-e21b066c">Diese Tablle ist als Beispiel gedacht. Alle Zusammenhänge sind frei erfunden.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-e21c13b6"><p class="cl-e21c0880"><span class="cl-e21b066c">* p &lt; .05, ** p &lt; .01, *** p &lt; .001</span></p></td></tr></tfoot></table></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-nicemlr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15
</figcaption>
</figure>
</div>
</div>
<p>Beim Vorliegen von diskreten Prädiktoren verweise ich auf das Kapitel “MLR mit diskreten Prädiktor”.</p>
</section>
<section id="voraussetzungen-regression" class="level2">
<h2 class="anchored" data-anchor-id="voraussetzungen-regression">Voraussetzungen Regression</h2>
<p>Die folgende Abbildung zeit die Relevanz der Prüfung der Voraussetzungen in der Regression. Jeder der vier Datensätze verfügt über die selbe Regressionsgerade und <span class="math inline">\(R^2 = 0.67\)</span>. Links oben (<span class="math inline">\(y_1\)</span>) ist keine der Voraussetzungen verletzt. Hier sind jedoch nicht alle Voraussetzungen abgebildet.</p>
<div id="fig-ascombe" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ascombe-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/Anscombe's_quartet_3.svg" id="fig-ascombe" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-ascombe-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16
</figcaption>
</figure>
</div>
<p><a href="https://de.wikipedia.org/wiki/Anscombe-Quartett#/media/Datei:Anscombe's_quartet_3.svg">Ascombe’s Quartett auf Wikipedia</a></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Statistische Voraussetzungen
</div>
</div>
<div class="callout-body-container callout-body">
<p>Beim Testen der Voraussetzungen können wir entweder deskriptivstatistische oder inferenzstatistische Verfahren verwenden. Deskriptivstatistisch kann man die Verfahren mit Plots untersuchen (z.B. Residual Plots, QQ Plots). Inferenzstatistiche Verfahren werden mit Tests durchgeführt (z.B. Kolmogorov-Smirnov Test). Beide Herangehensweisen haben ihre Probleme: 1. Deskriptivstatistische Verfahren sind subjektiv 2. Inferenzstatistische Verfahren haben eine geringe Power in kleinen Stichproben, was dazu führt, dass sie Verletzungen nicht zeigen. In größeren Stichproben haben sie eine hohe Power und werden auch bei geringfügigen Verletzungen signifikant. Das ist ungünstig, da die Verletzungen vor allem in kleinen Stichproben relevant sind. In großen Stichproben und balancierten Designs sind Verfahren wie die ANOVA einigermaßen robust gegen einige der Verletzungen.</p>
<p>Ich persönlich würde die deskriptivstatistischen Verfahren empfehlen. Im Zweifel kann man diese in Kombination mit inferenzstatistischen Verfahren verwenden.</p>
<section id="was-tun-bei-verletzungen-2" class="level4">
<h4 class="anchored" data-anchor-id="was-tun-bei-verletzungen-2">Was tun bei Verletzungen?</h4>
<p>Verletzungen sollten immer transparent berichtet werden. Informiere dich darüber, wie sensibel das verwendete statistische Verfahren auf solche Verletzungen reagiert. Falls Korrekturen vorgenommen werden (z.B. robuste Tests, Transformationen), ist es sinnvoll, die Analyse mit und ohne Korrektur durchzuführen und beide Ergebnisse anzugeben. Ein robuster Effekt sollte sich unter beiden Bedingungen zeigen. Dies ist z.B. hilfreich, wenn unklar ist, ob Ausreißer das Ergebnis verzerren. Ergänzend können simulationsbasierte Verfahren wie Bootstrapping oder Randomization Tests eingesetzt werden. Diese reduzieren die Abhängigkeit von theoretischen Annahmen und können die Robustheit der Ergebnisse erhöhen.</p>
</section>
</div>
</div>
<section id="homoskedastizität" class="level3">
<h3 class="anchored" data-anchor-id="homoskedastizität">Homoskedastizität</h3>
<section id="residual-plot-1" class="level4">
<h4 class="anchored" data-anchor-id="residual-plot-1">Residual Plot</h4>
<p>Ähnlich wie in der ANOVA können wir einen Residual Plot verwenden um die Homoskedastizität zu überprüfen (s. <a href="#fig-residualplotanova" class="quarto-xref">Figure&nbsp;8</a>). Die Residuen sind Abweichungen eines beobachteten Wertes von dem vorhergesagten Wert. In der Regression ist das die Abweichung eines Wert <span class="math inline">\(y_{i}\)</span> vom bedingten Erwartungswert <span class="math inline">\(E(y_i | X_i = x_i)\)</span>. Konkret bedeutet das die Abweichung eines Werts von der Regressionsgeraden (in y). Die Regressionsgerade gibt an, welchen y-Wert wird basierend auf dem x-Wert erwarten würden (<span class="math inline">\(E(y_i | X_i = x_i)\)</span>). Daher: <span class="math inline">\(e_{i} = y_{i} - \hat y_i\)</span>. Im nächsten Schritt standardisieren wir die Residuen. Hier können wir uns die standardisierten Residuen einfach ausgeben lassen <code>rstandard(model_mlr)</code>.</p>
<p>Ist die Varianzhomogenität gegeben, streuen die Werte zufällig um null. In diesem Fall zeigt sich das darin, dass wir keine Muster in den Residuen erkennen. Eine Verletzung anderer Voraussetzungen (Linearität, Unabhängigkeit der Messwerte, Ausreißer) kann sich ebenfalls im Residual Plot zeigen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract standardized residuals and fitted values</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(model_mlr)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>fitted_values <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model_mlr)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot residuals against fitted values</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">jitter</span>(fitted_values), residuals, <span class="at">xlab =</span> <span class="st">"Fitted Values"</span>, <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-residuenplotregression" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residuenplotregression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-residuenplotregression-1.png" id="fig-residuenplotregression" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-residuenplotregression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17
</figcaption>
</figure>
</div>
</div>
</div>
<p>Hinweis: der Code für den obigen Residual Plot ist identisch zum Residual Plot der ANOVA (<a href="#fig-residualplotanova" class="quarto-xref">Figure&nbsp;8</a>).</p>
</section>
</section>
<section id="linearität" class="level3">
<h3 class="anchored" data-anchor-id="linearität">Linearität</h3>
<p>Um die Linearität zu überprüfen, können wir uns für die untersuchten Zusammenhänge Scatterplots mit lokalen Regressionslinien (“loess”) untersuchen. Hier ist es empfehlenswert, sich den Scatterplot aus beiden Richtungen ausgeben zu lassen (beide Variablen jeweils auf der x und y-Achse). Wir können die Funktion zur Korrelationsmatrix aus <a href="#fig-ggpairscorplot" class="quarto-xref">Figure&nbsp;12</a> anpassen, um die obere Hälfte ebenfalls mit Scatterplots zu füllen.</p>
<p>Bei einer starken Verletzung oder bei non-linearen Zusammenhängen, können wir komplexere Verfahren (z.B. non-lineare Regression, quadratische Regression) verwenden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(df, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"IQ"</span>, <span class="st">"numerical_ability"</span>, <span class="st">"WMS4_delayed_recall"</span>), <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">"smooth"</span>,</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)), <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">"smooth"</span>, <span class="at">method =</span> <span class="st">"loess"</span>,</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggpairscatterplot" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggpairscatterplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-ggpairscatterplot-1.png" id="fig-ggpairscatterplot" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-ggpairscatterplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="normalverteilung-der-residuen" class="level3">
<h3 class="anchored" data-anchor-id="normalverteilung-der-residuen">Normalverteilung der Residuen</h3>
<p>Um die Normalverteilung der Residuen zu untersuchen, können wir wieder ein Histogramm und einen QQ-Plot der Residuen erstellen. Der Code ist wieder identisch zum QQ-Plot in der ANOVA (<a href="#fig-qqplotanova" class="quarto-xref">Figure&nbsp;10</a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wir extrahieren die residuen</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>residuals_mult_regression <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model_mlr)</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(residuals_mult_regression, <span class="at">main =</span> <span class="st">"QQ-Plot"</span>)</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(residuals_mult_regression)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-qqplotregression" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-qqplotregression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-qqplotregression-1.png" id="fig-qqplotregression" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-qqplotregression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rstandard</span>(model_mlr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-histregression" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-histregression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-histregression-1.png" id="fig-histregression" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-histregression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20
</figcaption>
</figure>
</div>
</div>
</div>
<p>Alternativ können wir die Schiefe und Kurtosis der Residuen überprüfen. Bei Vorliegen der Normalverteilung sind diese Werte nahe Null. Die absoluten Werte sollten <span class="math inline">\(\leq 1\)</span> sein. Die Kurtosis kann etwas höher ausfallen, sollte jedoch <span class="math inline">\(\leq 5\)</span> sein.</p>
<p>Schiefe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(residuals_mult_regression)<span class="sc">$</span>skew</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1736894</code></pre>
</div>
</div>
<p>Kurtosis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(residuals_mult_regression)<span class="sc">$</span>kurtosis</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1136742</code></pre>
</div>
</div>
</section>
<section id="unabhängigkeit-der-residuen-1" class="level3">
<h3 class="anchored" data-anchor-id="unabhängigkeit-der-residuen-1">Unabhängigkeit der Residuen</h3>
<p>Das Regressionsmodell geht davon aus, dass die Fehler (Residuen) unkorreliert sind. Wenn diese korreliert sind, könnte in den Daten eine Beziehung vorliegen, welche wir im Modell nicht erfasst haben. Das würde dazu führen, dass wir verzerrte Standardfehler für unsere Regressionskoeffizienten erhalten. Insgesamt empfiehlt es sich, die Unabhängigkeit der Residuen visuell im Residuenplot (<a href="#fig-residuenplotregression" class="quarto-xref">Figure&nbsp;17</a>) zu untersuchen. Wir wollen möglichst kein systematisches Muster erkennen.</p>
<p>Zusätzlich kann der Durbin-Watson Test verwendet werden, um die Abhängigkeit aufeinander folgender Residuen zu testen. Dieser testet die <span class="math inline">\(H_0\)</span>, ob eine Autokorrelation der Residuen vorliegt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">durbinWatsonTest</span>(model_mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> lag Autocorrelation D-W Statistic p-value
   1      0.04231597      1.897991   0.542
 Alternative hypothesis: rho != 0</code></pre>
</div>
</div>
</section>
<section id="ausreißer-1" class="level3">
<h3 class="anchored" data-anchor-id="ausreißer-1">Ausreißer</h3>
<p>Ausreißer können einen starken Einfluss auf die Regression haben (s. <a href="#fig-ascombe" class="quarto-xref">Figure&nbsp;16</a>). Wir können sie ebenfalls im Residual Plot (<a href="#fig-residuenplotregression" class="quarto-xref">Figure&nbsp;17</a>) oder in einem Scatterplot (<a href="#fig-ggpairscatterplot" class="quarto-xref">Figure&nbsp;18</a>) identifizieren. Alternativ können wir festgelegte Kriterien anwenden, beispielsweise Werte ausschließen, welche z.B. 3 Standardabweichungen vom Mittelwert entfernt sind.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mittelwert und Standardabweichung berechnen</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>mean_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(df<span class="sc">$</span>Alter)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>sd_value <span class="ot">&lt;-</span> <span class="fu">sd</span>(df<span class="sc">$</span>Alter)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Absoluter Abstand mehr als 3 SD</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>outlier <span class="ot">&lt;-</span> <span class="fu">abs</span>(df<span class="sc">$</span>Alter <span class="sc">-</span> mean_value) <span class="sc">&gt;</span> (<span class="dv">3</span> <span class="sc">*</span> sd_value)</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Visualize outliers</span></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> Alter, <span class="at">y =</span> Offenheit)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> outlier), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ausreißer" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ausreißer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-ausreißer-1.png" id="fig-ausreißer" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-ausreißer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21
</figcaption>
</figure>
</div>
</div>
</div>
<section id="multikollinearität" class="level4">
<h4 class="anchored" data-anchor-id="multikollinearität">Multikollinearität</h4>
<p>Multikollinearität ist nur relevant, wenn wir mehrere Prädiktoren verwenden. Multikollinearität liegt vor, wenn sich unsere Prädiktoren einen erheblichen Anteil an gemeinsamer Varianz teilen. Dies kann dazu führen, dass wir einen Effekte nicht mehr dem jeweiligen Prädiktor zuordnen können.</p>
<p>Zu erst sollten wir in einer Korrelationsmatrix überprüfen (s. <a href="#fig-ggpairscorplot" class="quarto-xref">Figure&nbsp;12</a>), wie sehr unsere Prädiktoren korreliert sind. Hohe Korrelationen sind ein Indikator für Multikollinearität.</p>
<p>Zudem können wir den Variance Inflation Factor (VIF) der Prädiktoren überprüfen. Dieser wird folgendermaßen berechnet: <span class="math inline">\(VIF_1 = \frac {1}{1- R^2_{1 \cdot 2 ... p}}\)</span>. 1 geteilt durch die Varianz im Prädiktor, welche nicht durch die andere Prädiktoren erklärt werden kann. Der VIF hat seinen Namen daher, dass er im Standardfehler des Regressionskoeffizienten enthalten ist und die Varianz, also auch den Standardfehler, in die Höhe treiben kann (“Inflation”). Dies kann dazu führen, dass wir Varianz im Modell aufklären können (<span class="math inline">\(R^2 \geq 0\)</span>), aber keiner der Prädiktoren signifikant wird.</p>
<p>Häufig genannte Cutoff-Werte für den VIF sind <span class="math inline">\(\leq\)</span> 5 und <span class="math inline">\(\leq\)</span> 10. VIF <span class="math inline">\(\leq\)</span> 5 gilt als gut, VIF <span class="math inline">\(\leq\)</span> 10 gelten i.d.R. als okay.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_mlr, <span class="at">type =</span> <span class="st">"predictor"</span>)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>vif_values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    GVIF Df GVIF^(1/(2*Df))      Interacts With
numerical_ability      1  3               1 WMS4_delayed_recall
WMS4_delayed_recall    1  3               1   numerical_ability
                    Other Predictors
numerical_ability               --  
WMS4_delayed_recall             --  </code></pre>
</div>
</div>
<p>Die Toleranz wird in SPSS zusätzlich zum VIF angegeben. Sie gibt den Nenner des VIF an und kann daher durch <span class="math inline">\(\frac{1}{VIF}\)</span> ermittelt werden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> vif_values[<span class="dv">1</span>][[<span class="dv">1</span>]]</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>tolerance_values <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>vif_values[<span class="dv">1</span>]</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>vif_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">VIF =</span> <span class="fu">round</span>(vif_values, <span class="dv">2</span>), <span class="at">Toleranz =</span> <span class="fu">round</span>(tolerance_values,</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>))</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="fu">nice_table</span>(vif_table, <span class="at">title =</span> <span class="fu">c</span>(<span class="st">"Tabelle 3"</span>, <span class="st">"VIF und Toleranz"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-viftolerance" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-viftolerance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tabwid"><style>.cl-e275ad5e{table-layout:auto;}.cl-e273a784{font-family:'Times New Roman';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e273a78e{font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e273a78f{font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e2747d9e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-e2747d9f{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-e2748780{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e2748781{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e2748782{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e2748783{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e274878a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e274878b{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e274878c{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-e275ad5e"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-e2748780"><p class="cl-e2747d9e"><span class="cl-e273a784">Tabelle 3</span></p></th></tr><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-e2748781"><p class="cl-e2747d9e"><span class="cl-e273a78e">VIF und Toleranz</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-e2748782"><p class="cl-e2747d9f"><span class="cl-e273a78f">VIF</span></p></th><th class="cl-e2748782"><p class="cl-e2747d9f"><span class="cl-e273a78f">Toleranz</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e2748783"><p class="cl-e2747d9e"><span class="cl-e273a78f">1.00</span></p></td><td class="cl-e274878a"><p class="cl-e2747d9f"><span class="cl-e273a78f">1.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e274878b"><p class="cl-e2747d9e"><span class="cl-e273a78f">1.00</span></p></td><td class="cl-e274878c"><p class="cl-e2747d9f"><span class="cl-e273a78f">1.00</span></p></td></tr></tbody></table></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-viftolerance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22
</figcaption>
</figure>
</div>
</div>
<section id="vorgehensweisen-bei-multikollinearität" class="level5">
<h5 class="anchored" data-anchor-id="vorgehensweisen-bei-multikollinearität">Vorgehensweisen bei Multikollinearität</h5>
<p>Beim Vorliegen von Multikollinearität können wir überlegen, Prädiktoren aus dem Modell zu entfernen oder mehrere Prädiktoren zu einem zusammenzufassen (z.B. Principal Component Analysis, PCA).</p>
</section>
</section>
</section>
</section>
<section id="mlr-mit-diskretem-prädiktor" class="level2">
<h2 class="anchored" data-anchor-id="mlr-mit-diskretem-prädiktor">MLR mit diskretem Prädiktor</h2>
<p><span class="math display">\[Y_i = \alpha + \beta_{1} \cdot D_{i} + \beta_2 \cdot X_1 + \beta_3 (D_i \cdot X_1) + \epsilon_i\]</span></p>
<p>Hierfür müssen wir sogenannte Dummy-Variablen (<span class="math inline">\(D_i\)</span>) erstellen. Hat der diskrete Prädiktor zwei Ausprägungen, legen wir eine der Kategorien als Referenzkategorie fest. Die Referenzkategorie kann frei gewählt werden, wir müssen uns jedoch für die Interpretation merken, welche Ausprägung wir als Referenz festgelegt haben.</p>
<p><span class="math inline">\(D_i = 0\)</span>: Person <span class="math inline">\(i\)</span> gehört zur Referenzkategorie</p>
<p><span class="math inline">\(D_i = 1\)</span>: Person <span class="math inline">\(i\)</span> gehört nicht zur Referenzkategorie</p>
<p>Für die Referenzkategorie (<span class="math inline">\(D_i = 0\)</span>), gilt:</p>
<p><span class="math display">\[\begin{align}
Y_i &amp;= \alpha + \beta_{1} \cdot 0 + \beta_2 \cdot X_1 + \beta_3 (0 \cdot X_1) + \epsilon_i \\
    &amp;= \alpha + \beta_2 \cdot X_1 + \epsilon_i
\end{align}\]</span></p>
<p>[error: passt nicht zusammen]</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rekodieren zu Dummy Variable</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>experimentalgruppe <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>bedingung <span class="sc">==</span> <span class="st">"Experimental"</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(df<span class="sc">$</span>bedingung <span class="sc">==</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Kontroll"</span>, <span class="dv">0</span>, <span class="cn">NA_real_</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>model_dummy_regression <span class="ot">&lt;-</span> <span class="fu">lm</span>(Extraversion <span class="sc">~</span> experimentalgruppe <span class="sc">+</span> Neurotizismus <span class="sc">+</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>    experimentalgruppe <span class="sc">*</span> Neurotizismus, <span class="at">data =</span> df)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_dummy_regression)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Extraversion ~ experimentalgruppe + Neurotizismus + 
    experimentalgruppe * Neurotizismus, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-22.6898  -5.8595  -0.0392   7.0103  24.4838 

Coefficients:
                                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                      41.71388    4.10540  10.161  &lt; 2e-16 ***
experimentalgruppe                0.16651    6.01442   0.028  0.97797    
Neurotizismus                    -0.36178    0.13056  -2.771  0.00674 ** 
experimentalgruppe:Neurotizismus -0.06386    0.18989  -0.336  0.73738    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.371 on 94 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.1625,    Adjusted R-squared:  0.1357 
F-statistic: 6.078 on 3 and 94 DF,  p-value: 0.0007943</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predicted values from the model</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>ex_predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_dummy_regression, <span class="at">newdata =</span> df)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot mit zwei separaten Regressionslinien</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> Neurotizismus, <span class="at">y =</span> Extraversion, <span class="at">color =</span> <span class="fu">factor</span>(experimentalgruppe))) <span class="sc">+</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span>  <span class="co"># Scatter points</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">y =</span> ex_predicted), <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span>  <span class="co"># Regression lines</span></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Neurotizismus"</span>, <span class="at">y =</span> <span class="st">"Extraversion"</span>, <span class="at">color =</span> <span class="st">"experimentalgruppe"</span>) <span class="sc">+</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-dummyscatter" class="quarto-float quarto-figure quarto-figure-center anchored" width="480">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dummyscatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-dummyscatter-1.png" id="fig-dummyscatter" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-dummyscatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;23
</figcaption>
</figure>
</div>
</div>
</div>
<p><em>das Beispiel ergibt wenig Sinn</em> <em>evtl. auf gesamte Range anpassen</em></p>
</section>
<section id="quadratische-regression" class="level2">
<h2 class="anchored" data-anchor-id="quadratische-regression">Quadratische Regression</h2>
<p>Wenn zwischen Prädiktor und Kriterium ein U-förmiger Zusammenhang besteht, kann es sinnvoll sein, den quadrierten Prädiktor in das Modell aufzunehmen. Idealerweise ist ein solcher Zusammenhang a-priori formuliert und theoretisch begründet. Alternativ kann bei einer Verletzung der Linearitätsannahme auch explorativ geprüft werden, ob ein nicht-linearer Zusammenhang vorliegt. Non-lineare Zusammenhänge in der Stichprobe können auch zufallsbedingt sein. Daher ist es nicht immer sinnvoll, einen explorativ gefundenen non-linearen Zusammenhang als solchen zu interpretieren. Wir können theoretisch auch Prädiktoren höherer Ordnung (bsp. <span class="math inline">\(x_1^3\)</span> oder <span class="math inline">\(x_1^4\)</span>) ins Modell mit aufnehmen. In der Psychologie sind solche Zusammenhänge allerdings sehr selten und wir laufen Gefahr zu “overfitten”, also unsystematische Varianz als systematisch zu interpretieren.</p>
<p>Die folgende Scatterplot-Matrix zeigt, warum man die Linearität am besten aus beiden Perspektiven – also mit jeweils vertauschter x- und y-Achse – beurteilen sollte. Der U-förmige Zusammenhang zwischen der Leistung (<code>correct_items</code>) und dem Vertrauen in die eigene Kompetenz (<code>confidence</code>) wird in der Ansicht [1,3] mit correct_items auf der x-Achse deutlich klarer als in der Ansicht [3,1].</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(df, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"correct_items"</span>, <span class="st">"IQ"</span>, <span class="st">"confidence"</span>), <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">"smooth"</span>,</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)), <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">"smooth"</span>, <span class="at">method =</span> <span class="st">"loess"</span>,</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggpairsscatterplotquad" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggpairsscatterplotquad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Statistik_Leitfaden_files/figure-html/fig-ggpairsscatterplotquad-1.png" id="fig-ggpairsscatterplotquad" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-ggpairsscatterplotquad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;24
</figcaption>
</figure>
</div>
</div>
</div>
<p>Im statistischen Modell verwenden wir idR. den herkömmlichen Prädiktor (<span class="math inline">\(x_1\)</span>) und seine quadratische Variante (<span class="math inline">\(x_1^2\)</span>). Die Interpretation des quadratischen Regressionskoeffizienten ist nicht mehr intuitiv: diese geben normalerweise die Steigung an. Im quadratischen Prädiktor hängt die Steigung von der Position auf der x-Achse ab. Wenn <span class="math inline">\(\beta_3 &gt; 0\)</span>, ist der non-lineare Zusammenhang U-förmig. Wenn <span class="math inline">\(\beta_3 &lt; 0\)</span>, ist der non-lineare Zusammenhang umgekehrt-U-förmig (wie im folgenden Beispiel). Dies ist die selbe Logik wie bei Parabeln in der Mathematik (<span class="math inline">\(y = x^2\)</span> vs.&nbsp;<span class="math inline">\(y = -x^2\)</span>)</p>
<p><span class="math display">\[Y_i = \alpha + \beta_1 \cdot x_{i1} +  \beta_2 \cdot x_{i2} + \beta_3  \cdot x_{i1}^2 + \epsilon_i\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>model_mlr_squared <span class="ot">&lt;-</span> <span class="fu">lm</span>(correct_items <span class="sc">~</span> confidence <span class="sc">+</span> IQ <span class="sc">+</span> <span class="fu">I</span>(confidence<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> df)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm.beta</span>(model_mlr_squared))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = correct_items ~ confidence + IQ + I(confidence^2), 
    data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-13.0540  -4.3895  -0.1755   3.3189  17.0304 

Coefficients:
                 Estimate Standardized Std. Error t value Pr(&gt;|t|)    
(Intercept)     -37.85467           NA    8.34827  -4.534 1.67e-05 ***
confidence        4.91374      1.05709    1.37373   3.577 0.000547 ***
IQ                0.60742      0.56395    0.08384   7.245 1.09e-10 ***
I(confidence^2)  -0.46906     -0.98688    0.14002  -3.350 0.001156 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.19 on 96 degrees of freedom
Multiple R-squared:  0.4334,    Adjusted R-squared:  0.4157 
F-statistic: 24.48 on 3 and 96 DF,  p-value: 7.557e-12</code></pre>
</div>
</div>
<p>Auch, wenn sich das <span class="math inline">\(\beta_2\)</span> des Prädiktors <span class="math inline">\(x_1^2\)</span> nicht gut interpretieren lässt, können wir testen, wie sehr es den gesamt-Fit verbessert, also wie viel zusätzliche Varianz im Modell es erklärt. Hierfür vergleichen wir das <span class="math inline">\(R^2\)</span> im Model mit Prädiktor und ohne Prädiktor. Siehe hierarchische Regression.</p>
<section id="hierarchische-regression" class="level4">
<h4 class="anchored" data-anchor-id="hierarchische-regression">Hierarchische Regression</h4>
<p>Wir können Prädiktoren in einer theoriegeleiteten Reihenfolge schrittweise in das Modell aufnehmen, um den zusätzlichen Beitrag eines neuen Prädiktors über die bereits enthaltenen Prädiktoren hinaus zu analysieren. Im folgenden Beispiel interessiert uns, ob der quadratische Term von confidence (also confidence²) den Modellfit signifikant verbessert, nachdem bereits confidence (linear) und IQ berücksichtigt wurden. Das sog. Full Model, also mit confidence², ist eine komplexere Version des Reduced Model.</p>
<p>Reduced Model: <span class="math inline">\(Y_i = \alpha + \beta_1 \cdot x_{i1} + \beta_2 \cdot x_{i2} + \epsilon_i\)</span></p>
<p>Full Model: <span class="math inline">\(Y_i = \alpha + \beta_1 \cdot x_{i1} + \beta_2 \cdot x_{i2} + \beta_3 \cdot x_{i1}^2 + \epsilon_i\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>model_red <span class="ot">&lt;-</span> <span class="fu">lm</span>(correct_items <span class="sc">~</span> confidence <span class="sc">+</span> IQ, <span class="at">data =</span> df)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_red)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = correct_items ~ confidence + IQ, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-13.7822  -4.0263   0.1971   3.3967  13.4070 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -30.77834    8.49156  -3.625 0.000463 ***
confidence    0.47330    0.37944   1.247 0.215258    
IQ            0.62771    0.08792   7.140 1.72e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.508 on 97 degrees of freedom
Multiple R-squared:  0.3671,    Adjusted R-squared:  0.3541 
F-statistic: 28.14 on 2 and 97 DF,  p-value: 2.308e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(correct_items <span class="sc">~</span> confidence <span class="sc">+</span> IQ <span class="sc">+</span> <span class="fu">I</span>(confidence<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> df)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = correct_items ~ confidence + IQ + I(confidence^2), 
    data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-13.0540  -4.3895  -0.1755   3.3189  17.0304 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     -37.85467    8.34827  -4.534 1.67e-05 ***
confidence        4.91374    1.37373   3.577 0.000547 ***
IQ                0.60742    0.08384   7.245 1.09e-10 ***
I(confidence^2)  -0.46906    0.14002  -3.350 0.001156 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.19 on 96 degrees of freedom
Multiple R-squared:  0.4334,    Adjusted R-squared:  0.4157 
F-statistic: 24.48 on 3 and 96 DF,  p-value: 7.557e-12</code></pre>
</div>
</div>
<p>Das <span class="math inline">\(\Delta R^2\)</span> beträgt <span class="math inline">\(0.06\)</span> (<span class="math inline">\(R^2_{Full} - R^2_{Red} = 0.433 - 0.367 = 0.066\)</span>). Das bedeutet, dass das Full Model 6.6% mehr Varianz im Kriterium <code>correct_items</code> erklärt als das Reduced Model.</p>
<p>Wir verwenden die <code>anova</code>-Funktion um zu testen, ob der Fit durch das neue Modell signifikant besser ist. Diese misst mit dem aus der Anova bekannten Omnibus F-Test, ob die Verbesserung im Fit statistisch signifikant ist. Das Reduced Model und Full Model müssen hierfür “nested”, also verschachtelt, sein (das Full Model ist eine komplexere Version des Reduced Model).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_red, model_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: correct_items ~ confidence + IQ
Model 2: correct_items ~ confidence + IQ + I(confidence^2)
  Res.Df    RSS Df Sum of Sq      F   Pr(&gt;F)   
1     97 4108.8                                
2     96 3678.8  1    430.07 11.223 0.001156 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Die Hinzunahme des quadratischen Terms von Vertrauen in die eigene Leistung verbessert die Vorhersage der korrekt gelösten Items signifikant über das hinaus, was durch IQ und den linearen Zusammenhang mit Vertrauen erklärt wird, <span class="math inline">\(\Delta R^2 = 0.06, F(1, 96) = 11.22, p = .001\)</span>.</p>
</section>
</section>
</section>
<section id="bootstrapping" class="level1">
<h1>Bootstrapping</h1>
<p>Bootstrapping ist eine sogenannte Resampling-Methode. Das bedeutet, dass wir aus der vorliegenden Stichprobe zahlreiche neue Stichproben ziehen – und zwar mit Zurücklegen. Das heißt: Eine Person kann in einer neuen Stichprobe mehrfach oder gar nicht vorkommen.</p>
<p>Für jede dieser neuen Stichproben berechnen wir eine Statistik, zum Beispiel einen Mittelwert oder eine Effektgröße. Dadurch erhalten wir eine Verteilung dieser Statistik über alle resampleten Stichproben hinweg. Diese Verteilung erlaubt es uns, Aussagen über die Präzision der Parameterschätzung zu treffen.</p>
<p>In der Praxis wird häufig ein 95%-Konfidenzintervall für den interessierenden Parameter berechnet.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function to compute F-statistic</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>boot_anova <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>    sample_data <span class="ot">&lt;-</span> data[indices, ]  <span class="co"># Resample data</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>    anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(wellbeing_t2 <span class="sc">~</span> therapy_group, <span class="at">data =</span> sample_data)</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">summary</span>(anova_result)[[<span class="dv">1</span>]][<span class="st">"therapy"</span>, <span class="st">"F value"</span>])  <span class="co"># Extract F-value</span></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply bootstrapping with 1000 resamples</span></span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a>boot_result_anova <span class="ot">&lt;-</span> <span class="fu">boot</span>(df_2_wide, <span class="at">statistic =</span> boot_anova, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a><span class="co"># View bootstrapped F-distribution</span></span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(boot_result_anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ORDINARY NONPARAMETRIC BOOTSTRAP


Call:
boot(data = df_2_wide, statistic = boot_anova, R = 1000)


Bootstrap Statistics :
    original   bias    std. error
t1*  5.22941 1.117851    3.705642</code></pre>
</div>
</div>
<section id="weitere-ressourcen-für-r" class="level2">
<h2 class="anchored" data-anchor-id="weitere-ressourcen-für-r">Weitere Ressourcen für R</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Thema</th>
<th style="text-align: left;">Beschreibung</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://r4ds.hadley.nz/">R for Data Science</a></td>
<td style="text-align: left;">Einführung in Datenanalyse mit dem tidyverse</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://learningstatisticswithr.com/book/">Learning Statistics with R</a></td>
<td style="text-align: left;">Statistik-Tutorial für Psychologie-Studierende</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://rstudio.github.io/cheatsheets/html/data-transformation.html">Data Transformation mit <code>dplyr</code></a></td>
<td style="text-align: left;">Cheatsheet zur Datenmanipulation</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://rstudio.github.io/cheatsheets/html/tidyr.html">Data Tidying mit <code>tidyr</code></a></td>
<td style="text-align: left;">Cheatsheet zum Aufräumen von Daten</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://rstudio.github.io/cheatsheets/html/data-import.html">Data Import mit dem tidyverse</a></td>
<td style="text-align: left;">Cheatsheet zum Einlesen von Daten</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://rstudio.github.io/cheatsheets/html/factors.html">Faktoren mit <code>forcats</code></a></td>
<td style="text-align: left;">Cheatsheet zum Umgang mit kategorialen Variablen</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="notes-footnotes" class="level1">
<h1>Notes &amp; footnotes</h1>
<ul>
<li>auf type 3 sum of squares eingehen?</li>
<li>long format</li>
<li>evtl. darauf eingehen wie man bei MW eine ID hinzufügt</li>
<li>geplante Kontraste theoretische Fundierung</li>
<li>scheffe</li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>